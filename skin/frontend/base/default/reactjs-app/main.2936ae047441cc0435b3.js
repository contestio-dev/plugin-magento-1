(()=>{"use strict";var e,t,a,r={22330:(e,t,a)=>{var r=a(96540),n=a(5338),l=a(84976),s=a(47767),o=a(64721),c=a(85902),i=a(34164),m=a(50856);function d(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,m.QP)((0,i.$)(t))}function u(e){return new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"})}var p=a(53110),f=a(71083);const g="/index.php/contestio/api/proxy?endpoint=",h=async e=>await f.A.get(g+e),x=async(e,t,a)=>await f.A.post(g+e,t,{headers:a}),b=async(e,t)=>await f.A.patch(g+e,t),E=(0,r.createContext)(void 0);function v(e){let{children:t}=e;const a=(0,s.Zp)(),{pathname:n}=(0,s.zy)(),[l,o]=(0,r.useState)({primary:"234 85% 73%",secondary:"46 91% 75%"}),[c,i]=(0,r.useState)(!0),[m,d]=(0,r.useState)([]),[u,f]=(0,r.useState)(null),[g,x]=(0,r.useState)(!0),[b,v]=(0,r.useState)([]),[w,N]=(0,r.useState)(!0),[y,C]=(0,r.useState)(null),[O,P]=(0,r.useState)(!1),[j,k]=(0,r.useState)(null);(0,r.useEffect)((()=>{"/error"!==n&&S()}),[]);const S=async()=>{try{const{data:e}=await h("v1/org/header");d(e.buttons||[]),C(e.banner);const t=e.colors?.colors,a=t?.primary.replace(/hsl\(|\)|,/g,"").replace(/\s+/g," ").trim(),r=t?.secondary.replace(/hsl\(|\)|,/g,"").replace(/\s+/g," ").trim();a&&r&&o({primary:a,secondary:r}),N(!1);const n=e.user||null,l=null!==n.pseudo&&void 0!==n.pseudo&&n.pseudo?.length>0;if(!Object.values(n).every((e=>null===e||""===e))&&l)f(n);else{const{data:e}=await h("me");f(e)}}catch(e){e instanceof p.pe&&(console.error(e),401===e.response?.status?a("/error?auth=true"):a("/error"))}finally{i(!1)}};return(0,r.useEffect)((()=>{u?.pseudo&&(document.cookie="contestio_oauth=; max-age=0")}),[u?.pseudo]),r.createElement(E.Provider,{value:{colors:l,user:u,setUser:f,appLoading:c,navButtons:m,homepageLoading:g,homepageContent:b,setHomepageLoading:x,setHomepageContent:v,banner:y,bannerLoading:w,isCodePromoOpen:O,setIsCodePromoOpen:P,codePromo:j,setCodePromo:k}},t)}function w(){const e=(0,r.useContext)(E);if(void 0===e)throw new Error("useAppContext doit être utilisé à l'intérieur d'un AppProvider");return e}var N=a(33362),y=a(80097);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},C.apply(null,arguments)}const O=(0,y.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-white hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80 active:bg-destructive/60",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-black hover:bg-secondary/80",ghost:"text-primary text-md font-medium hover:bg-primary/10","ghost-destructive":"text-destructive text-md font-medium hover:bg-destructive/10",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),P=r.forwardRef(((e,t)=>{let{className:a,variant:n,size:l,asChild:s=!1,...o}=e;const c=s?N.DX:"button";return r.createElement(c,C({className:d(O({variant:n,size:l,className:a})),ref:t},o))}));function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},j.apply(null,arguments)}function k(e){let{className:t,...a}=e;return r.createElement("div",j({className:d("animate-pulse rounded-md bg-muted",t)},a))}P.displayName="Button";var S=a(35847);function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},A.apply(null,arguments)}const R=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(S.bL,A({ref:t,className:d("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a)},n))}));R.displayName=S.bL.displayName;const _=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(S._V,A({ref:t,className:d("aspect-square h-full w-full",a)},n))}));_.displayName=S._V.displayName;const z=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(S.H4,A({ref:t,className:d("flex h-full w-full items-center justify-center rounded-full bg-muted",a)},n))}));z.displayName=S.H4.displayName;var L=a(3881);function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},I.apply(null,arguments)}const U=L.Kq,F=L.bL,M=L.l9,$=r.forwardRef(((e,t)=>{let{className:a,sideOffset:n=4,...l}=e;return r.createElement(L.UC,I({ref:t,sideOffset:n,className:d("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a)},l))}));function V(){return function(e){const[t,a]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const r=window.matchMedia(e);r.matches!==t&&a(r.matches);const n=()=>a(r.matches);return r.addListener(n),()=>r.removeListener(n)}),[t,e]),t}("(max-width: 768px)")}$.displayName=L.UC.displayName;const T=function(){const e=V(),t=(0,s.Zp)(),{appLoading:a,user:n,banner:l,navButtons:o,bannerLoading:c}=w(),i=window.location.pathname.split("/").pop(),m="/"===i||""===i||"contestio"===i,u="contests"===i,p="surveys"===i,f="news"===i;return r.createElement("header",{className:"w-full flex flex-col"},r.createElement("div",{className:d("relative flex flex-col gap-5 h-80 w-full bg-cover bg-center"),style:{backgroundImage:l?.presignedUrl||l?.mobilePresignedUrl?`url(${e&&l.mobilePresignedUrl?l.mobilePresignedUrl:l.presignedUrl})`:"none"}},c&&r.createElement(r.Fragment,null,r.createElement("div",{className:"bg-gradient-to-br from-black/10 to-black/30 w-full h-full"}),r.createElement("div",{className:"absolute text-2xl text-left md:text-4xl top-4 left-4 w-2/4 md:w-1/4"},r.createElement(k,{className:"h-[20px] md:h-[30px] w-[180px] md:w-[230px] rounded-xl mb-1"}),r.createElement(k,{className:"h-[20px] md:h-[30px] w-[180px] md:w-[230px] rounded-xl"})),r.createElement("div",{className:"absolute bottom-8 left-0 right-0 w-full px-8 text-left"},r.createElement(k,{className:"h-[20px] w-[100%] rounded-xl mb-1"}),r.createElement(k,{className:"h-[20px] w-[230px] rounded-xl"}))),!c&&l?.showText&&r.createElement(r.Fragment,null,r.createElement("div",{className:"bg-gradient-to-b from-black/10 to-black/70 md:to-black/50 w-full h-full"}),r.createElement("h1",{className:"text-white text-3xl text-left md:text-[2.5em] leading-tight font-bold absolute top-4 left-4 w-3/4 md:w-2/5 drop-shadow-md whitespace-normal"},l.title),r.createElement("p",{className:"text-white text-md font-semibold absolute bottom-4 md:bottom-8 left-4 right-4 px-2 md:px-8 text-left drop-shadow-md"},l.description))),r.createElement("nav",{className:"flex justify-between items-center gap-2 md:gap-5 border-b border-border/30 px-4 md:px-16 bg-white shadow overflow-x-auto no-scrollbar"},r.createElement("div",{className:"flex items-center gap-5 pt-4"},0===o.length&&a?r.createElement(r.Fragment,null,r.createElement(k,{className:"h-[20px] w-[100px] rounded-xl mb-4"}),r.createElement(k,{className:"h-[20px] w-[100px] rounded-xl mb-4"})):o.map((e=>(e=>{const a="contest"===e.navUrl?u:"survey"===e.navUrl?p:"news"===e.navUrl?f:m;return r.createElement(P,{key:e.slug,id:e.slug,onClick:()=>{return a=e.navUrl||"",void t("contest"===a?"/contests":"survey"===a?"/surveys":"news"===a?"/news":"/");var a},className:d("bg-white text-primary font-bold border-0 rounded-none border-b-2 pb-5 border-transparent","hover:border-primary/50 hover:bg-white hover:text-primary/70","active:border-primary/80 active:text-primary/80",a&&"border-primary hover:border-primary hover:bg-white hover:text-primary")},e.text)})(e)))),n&&n.pseudo&&r.createElement(F,null,r.createElement(M,{asChild:!0},r.createElement(P,{variant:"ghost",onClick:()=>t("/profile"),className:d("flex justify-end items-center gap-2 border border-border/70 bg-white rounded-md ml-5 px-2 py-1 shadow","cursor-pointer hover:border-border hover:shadow-md hover:bg-white transition-all duration-300")},r.createElement("span",{className:"text-md font-normal text-primary"},n.pseudo),r.createElement(R,{className:"w-7 h-7"},r.createElement(_,{src:n.avatar}),r.createElement(z,{className:"text-muted-foreground font-medium text-sm bg-secondary"},(n.firstName+" "+n.pseudo).split(" ").filter((e=>""!==e)).map((e=>e[0])).join(""))))),r.createElement($,{className:"bg-white text-black"},r.createElement("p",null,"Voir mon profil")))))};function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},q.apply(null,arguments)}const D=function(e){return r.createElement("a",q({},e,{className:d("text-muted-foreground border-b border-b-transparent no-underline","hover:no-underline hover:border-b-primary hover:text-primary transition-all duration-300",e.className)}))},B="0.1.0",H=function(){const e=`https://contestio.fr/report-bug?url=${window.location.href}&version=${B}`;return r.createElement("footer",{className:"w-full my-0 flex justify-center md:justify-end items-center"},r.createElement("div",{className:"flex items-center gap-2 text-sm text-muted-foreground"},r.createElement(D,{href:e,target:"_blank"},"Signaler un bug"),r.createElement("span",{className:"border-b border-b-transparent"},"-"),r.createElement("span",{className:"font-light border-b border-b-transparent"},"Powered by"),r.createElement(D,{href:"https://contestio.fr",target:"_blank"},"Contestio"),r.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/logo.png",alt:"Contestio",height:20,width:20})))};var J=a(14476),Z=a(49785),K=a(9013),W=a(59353),Y=a(70893),Q=a(25191),G=a(60990),X=a(24082);const ee=e=>{let{icon:t,filledRed:a,fill:n,className:l}=e;const s=(0,X.A)(t);return r.createElement("span",{dangerouslySetInnerHTML:{__html:s.outerHTML},className:d("[&_svg]:w-full [&_svg]:h-full",a?"[&_svg]:fill-red-500":n&&`[&_svg]:fill-${n}`,l)})};function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},te.apply(null,arguments)}const ae=e=>{let{children:t,...a}=e;const[n,l]=r.useState(a.open||!1);return r.createElement(G.bL,te({modal:!0,open:n,onOpenChange:e=>{l(e),a.onOpenChange?.(e)}},a),t)},re=G.l9,ne=e=>{let{children:t,...a}=e;const n=document.getElementById("contestio-layout");return r.createElement(G.ZL,te({},a,{container:n}),t)},le=(G.bm,r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(ne,null,r.createElement("div",{className:"absolute inset-0 w-full z-50 bg-white/75 backdrop-blur animate-fade-in"}),r.createElement(G.UC,te({ref:t,className:d("contestioModal fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg max-h-[63vh] overflow-auto translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-10 shadow duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-xl",a)},l),n,r.createElement(G.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},ee({icon:Q.A,className:"size-4"}),r.createElement("span",{className:"sr-only"},"Close"))))})));le.displayName=G.UC.displayName;const se=e=>{let{className:t,...a}=e;return r.createElement("div",te({className:d("flex flex-col space-y-1.5 text-center sm:text-left",t)},a))};se.displayName="DialogHeader";const oe=e=>{let{className:t,...a}=e;return r.createElement("div",te({className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},a))};oe.displayName="DialogFooter";const ce=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(G.hE,te({ref:t,className:d("text-lg font-semibold leading-none tracking-tight",a)},n))}));ce.displayName=G.hE.displayName;const ie=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(G.VY,te({ref:t,className:d("text-sm text-muted-foreground",a)},n))}));ie.displayName=G.VY.displayName;var me=a(97248),de=a(40961);function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ue.apply(null,arguments)}const pe=e=>{let{shouldScaleBackground:t=!0,...a}=e;return r.createElement(me._s.Root,ue({shouldScaleBackground:t},a))};pe.displayName="Drawer";const fe=me._s.Trigger,ge=e=>{let{children:t}=e;const[a,n]=r.useState(!1);return r.useEffect((()=>(n(!0),()=>n(!1))),[]),a?de.createPortal(t,document.getElementById("root")):null},he=(me._s.Close,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(me._s.Overlay,ue({ref:t,className:d("fixed inset-0 z-50 bg-black/80",a)},n))})));he.displayName=me._s.Overlay.displayName;const xe=r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(ge,null,r.createElement(he,null),r.createElement(me._s.Content,ue({ref:t,className:d("fixed inset-x-0 bottom-0 px-4 z-50 mt-24 mx-auto flex h-auto flex-col rounded-t-[10px] border bg-background !max-w-full",a)},l),r.createElement("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),n))}));xe.displayName="DrawerContent";const be=e=>{let{className:t,...a}=e;return r.createElement("div",ue({className:d("grid gap-1.5 p-4 mb-2 text-center sm:text-left",t)},a))};be.displayName="DrawerHeader";const Ee=e=>{let{className:t,...a}=e;return r.createElement("div",ue({className:d("mt-2 flex flex-col gap-2 p-4",t)},a))};Ee.displayName="DrawerFooter";const ve=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(me._s.Title,ue({ref:t,className:d("text-lg font-semibold leading-none tracking-tight",a)},n))}));function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},we.apply(null,arguments)}ve.displayName=me._s.Title.displayName,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(me._s.Description,ue({ref:t,className:d("text-sm text-muted-foreground",a)},n))})).displayName=me._s.Description.displayName;const Ne=e=>{let{children:t,...a}=e;return V()?r.createElement(pe,a,t):r.createElement(ae,a,t)};Ne.displayName="Modal";const ye=r.forwardRef(((e,t)=>{let{children:a,...n}=e;const l=V()?fe:re;return r.createElement(l,{asChild:!0},r.createElement(P,we({ref:t},n),a))}));ye.displayName="ModalTrigger",r.forwardRef(((e,t)=>{let{children:a,...n}=e;const l=V()?fe:re;return r.createElement(l,we({asChild:!0,ref:t},n),a)})).displayName="ModalTriggerDiv";const Ce=e=>{let{children:t,...a}=e;return V()?r.createElement(xe,a,t):r.createElement(le,a,t)};Ce.displayName="ModalContent";const Oe=e=>{let{children:t,...a}=e;return V()?r.createElement(be,a,t):r.createElement(se,a,t)};Oe.displayName="ModalHeader";const Pe=e=>{let{children:t,...a}=e;return V()?r.createElement(Ee,a,t):r.createElement(oe,a,t)};Pe.displayName="ModalFooter";const je=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return V()?r.createElement(ve,we({ref:t,className:d("text-lg font-semibold",a)},n)):r.createElement(ce,we({ref:t,className:d("text-lg font-semibold",a)},n))}));je.displayName="ModalTitle";const ke=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(ie,we({ref:t,className:d("text-sm text-muted-foreground",a)},n))}));function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Se.apply(null,arguments)}ke.displayName=ie.displayName;const Ae=r.forwardRef(((e,t)=>{let{className:a,type:n,...l}=e;return r.createElement("input",Se({type:n,className:d("flex h-10 !w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/20 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 accent-primary",a),ref:t},l))}));Ae.displayName="Input";var Re=a(95920);function _e(){return _e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_e.apply(null,arguments)}const ze=(0,y.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Le=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(Re.b,_e({ref:t,className:d(ze(),a)},n))}));Le.displayName=Re.b.displayName;var Ie=a(28710),Ue=a(65550);function Fe(){return Fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Fe.apply(null,arguments)}const Me=(0,r.forwardRef)(((e,t)=>{let{className:a,...n}=e;const[l,s]=(0,r.useState)(!1);return r.createElement("div",{className:"relative flex items-center"},r.createElement(Ae,Fe({type:l?"text":"password",className:d("hide-password-toggle pr-10",a),ref:t},n)),r.createElement(P,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-[0] h-full px-3 py-2 hover:bg-transparent",onClick:()=>s((e=>!e))},ee({icon:l?Ie.A:Ue.A,className:"h-4 w-4"})),r.createElement("style",null,"\n\t\t\t\t\t.hide-password-toggle::-ms-reveal,\n\t\t\t\t\t.hide-password-toggle::-ms-clear {\n\t\t\t\t\t\tvisibility: hidden;\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\tdisplay: none;\n\t\t\t\t\t}\n          "))}));function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},$e.apply(null,arguments)}Me.displayName="PasswordInput";const Ve=J.z.object({email:J.z.string().email({message:"Email invalide"}).min(1,{message:"L'email est requis"}).max(255,{message:"L'email doit contenir moins de 255 caractères"}),password:J.z.string().min(1,{message:"Le mot de passe est requis"}).max(255,{message:"Le mot de passe doit contenir moins de 255 caractères"})});function Te(e){let{open:t,setOpen:a}=e;const[n,l]=(0,r.useState)(!1),{register:s,getValues:c,handleSubmit:i,formState:{errors:m}}=(0,Z.mN)({resolver:(0,Y.u)(Ve)});return(0,r.useEffect)((()=>{t&&(document.cookie.includes("contestio_oauth"),document.cookie="contestio_oauth=true; max-age=3600000")}),[t]),r.createElement(Ne,{open:t,onOpenChange:a},r.createElement(Ce,{className:"md:max-w-sm"},r.createElement(Oe,null,r.createElement(je,null,"Connexion"),r.createElement(ke,null,"Connectez-vous à votre compte pour accéder à toutes les fonctionnalités de Contestio.")),r.createElement("form",{onSubmit:i((async()=>{const e=new FormData;e.append("username",c("email")),e.append("password",c("password"));try{l(!0);const{data:t}=await(async e=>await f.A.post("/index.php/contestio/login/post/",e))(e);t.success?(o.oR.success("Connexion en cours..."),window.location.reload()):(l(!1),o.oR.error(t.message||"Une erreur est survenue"))}catch(e){console.error(e),l(!1),o.oR.error("Erreur lors de la connexion")}})),className:"w-full flex flex-col gap-5"},r.createElement("div",{className:"w-full max-w-sm items-center gap-1.5 mb-2"},r.createElement(Le,{htmlFor:"email"},"Email"),r.createElement(Ae,$e({type:"email",id:"email",placeholder:"Email",maxLength:256},s("email"))),m.email&&r.createElement("span",{className:"text-sm text-destructive"},m.email.message)),r.createElement("div",{className:"w-full max-w-sm items-center gap-1.5"},r.createElement("div",{className:"w-full flex justify-between"},r.createElement(Le,{htmlFor:"password"},"Mot de passe"),r.createElement(D,{href:"/index.php/customer/account/forgotpassword/",className:"text-sm text-muted-foreground"},"Mot de passe oublié ?")),r.createElement(Me,$e({className:"w-full",placeholder:"Mot de passe",maxLength:256},s("password"))),m.password&&r.createElement("span",{className:"text-sm text-destructive"},m.password.message)),r.createElement(Pe,{className:"mt-2 flex !flex-col gap-5 justify-center"},r.createElement(P,{type:"submit",disabled:n,className:"w-fit mx-auto flex items-center gap-2"},"Se connecter",ee({icon:n?K.A:W.A,className:"w-4 h-4 "+(n?"animate-spin":"")})),r.createElement("p",{className:"text-center text-sm text-muted-foreground"},"Je n'ai pas de compte ?"," ",r.createElement(D,{href:`/index.php/customer/account/create/?redirect=${encodeURIComponent(window.location.href)}`,className:"text-primary"},"Créer un compte"))))))}var qe=a(35942),De=a(24750);function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Be.apply(null,arguments)}const He=J.z.object({pseudo:J.z.string().min(2,{message:"Le pseudo doit contenir au moins 2 caractères."}).max(12,{message:"Le pseudo doit contenir moins de 12 caractères."}).regex(/^[a-zA-Z0-9_]+$/,{message:"Le pseudo ne peut contenir que des lettres, des chiffres et des underscores."})});function Je(e){let{open:t,setOpen:a}=e;const[n,l]=(0,r.useState)(""),[s,c]=(0,r.useState)(!1),[i,m]=(0,r.useState)(!1),{user:u,setUser:f}=w(),{register:g,handleSubmit:h,formState:{errors:b},setError:E}=(0,Z.mN)({resolver:(0,Y.u)(He)});return r.createElement(Ne,{open:t,onOpenChange:a},r.createElement(Ce,{className:"md:max-w-sm"},!0===i&&r.createElement("div",{className:"absolute top-0 left-0 w-full h-10 flex items-center justify-center"},r.createElement(De.A,{zIndex:50})),r.createElement(Oe,null,r.createElement(je,null,"Hey ",u?.firstName," 👋"),r.createElement(ke,null,r.createElement(F,null,r.createElement(M,{asChild:!0},r.createElement("p",{className:""},"Avant de continuer, pourriez-vous nous donner"," ",r.createElement("span",{className:"text-muted-foreground italic"},"votre pseudo")," ","?")),r.createElement($,{className:"bg-white text-black",side:"bottom"},r.createElement("div",{className:"flex flex-col gap-2 max-w-[300px]"},r.createElement("p",{className:"font-semibold"},"Règles de création de pseudo :"),r.createElement("p",null,"Il doit être unique et ne peut contenir que des lettres, des chiffres et des underscores et doit contenir entre 2 et 12 caractères.")))))),!1===i?r.createElement("form",{onSubmit:h((async()=>{if(u&&u.id)if(u.pseudo)o.oR.error("Vous avez déjà un pseudo.");else try{c(!0);const e=document.cookie.includes("contestio_oauth");await x("pseudo",{pseudo:n,isFromContestio:e}),f({...u,pseudo:n}),o.oR.success(`Bienvenue ${n} !`,{description:"Votre pseudo a bien été enregistré."}),c(!1),m(!0)}catch(e){if(c(!1),e instanceof p.pe)return void o.oR.error(e.response?.data?.message||"Une erreur est survenue lors de la modification de votre pseudo");console.error(e),o.oR.error("Une erreur est survenue lors de la modification de votre pseudo")}else o.oR.error("Une erreur est survenue lors de la récupération de vos informations")})),className:"flex flex-col gap-2"},r.createElement("div",{className:"mt-3 w-full max-w-sm items-center"},r.createElement(Ae,Be({type:"text",id:"pseudo",autoComplete:"off",placeholder:"Votre pseudo",maxLength:12,disabled:s,className:d("border-2 border-primary/50 text-primary font-medium text-center text-lg !h-10","placeholder:text-primary/50",!!b.pseudo?.message&&"border-destructive",s&&"bg-primary/20")},g("pseudo"),{onChange:e=>{(e=>{l(e.target.value),E("pseudo",{message:""})})(e),g("pseudo").onChange(e)}})),r.createElement("div",{className:"w-full flex justify-end items-center"},r.createElement("span",{className:"text-sm text-muted-foreground"},n?.length," / 12")),b.pseudo&&r.createElement("div",{className:"w-full text-center mt-1"},r.createElement("span",{className:"text-sm text-destructive font-semibold"},b.pseudo.message))),r.createElement(Pe,{className:"mt-2 flex !flex-col gap-5 justify-center"},r.createElement(P,{type:"submit",disabled:s,className:"w-fit mx-auto flex items-center gap-2 p-4 text-md rounded-full"},"Valider",ee({icon:s?K.A:qe.A,className:"w-5 h-5 "+(s?"animate-spin":"")})),r.createElement("p",{className:"text-sm text-muted-foreground text-center"},"Il sera utilisé pour vous identifier lors de vos participations aux concours et sondages."))):r.createElement("div",{className:"flex flex-col gap-2 items-center"},r.createElement("p",{className:"text-lg font-semibold"},"Bienvenue",r.createElement("span",{className:"text-primary font-semibold ml-1"},u?.pseudo)," ","!"),r.createElement("p",{className:"mt-2 text-muted-foreground text-center"},"Vous pouvez désormais participer à nos concours et sondages."),r.createElement(Pe,{className:"mt-2"},r.createElement(P,{onClick:()=>a(!1),variant:"outline",className:"w-fit "},"Fermer")))))}const Ze=(0,r.createContext)({isLoginOpen:!1,setIsLoginOpen:()=>{},isPseudoOpen:!1,setIsPseudoOpen:()=>{}}),Ke=()=>(0,r.useContext)(Ze),We=e=>{let{children:t}=e;const[a,n]=(0,r.useState)(!1),[l,s]=(0,r.useState)(!1);return r.createElement(Ze.Provider,{value:{isLoginOpen:a,setIsLoginOpen:n,isPseudoOpen:l,setIsPseudoOpen:s}},t)};var Ye=a(58207),Qe=a(3118);function Ge(e){let{open:t,setOpen:a}=e;const[n,l]=(0,r.useState)(!1),{user:s,codePromo:c}=w();return(0,r.useEffect)((()=>{l(!0)}),[t]),r.createElement(Ne,{open:t&&null!==c,onOpenChange:a},r.createElement(Ce,{className:"md:max-w-sm"},!0===n&&r.createElement("div",{className:"absolute top-0 left-0 w-full h-10 flex items-center justify-center"},r.createElement(De.A,{zIndex:50})),r.createElement(Oe,null,r.createElement(je,{className:"flex items-center"},ee({icon:Ye.A,className:"w-5 h-5 mr-1"})," ","Code promo"),r.createElement(ke,null,"Merci",r.createElement("span",{className:"text-primary font-medium mx-1"},s?.pseudo),"pour ta participation ! Récupère ton code promo ci-dessous :")),r.createElement("div",{className:"flex flex-col gap-2 items-center"},r.createElement(P,{variant:"outline",className:"w-fit text-md bg-white font-semibold border p-3 my-3 rounded-xl shadow",onClick:()=>{navigator.clipboard.writeText(c?.value),o.oR.success("Code promo copié !")}},c?.value,r.createElement(F,null,r.createElement(M,{className:"ml-2 h-5 p-0 m-0 text-primary",asChild:!0},ee({icon:Qe.A,className:"w-4 h-4"})),r.createElement($,{className:"bg-white text-black"},r.createElement("p",null,"Copier le code promo")))),r.createElement("p",{className:"mt-2 text-sm text-muted-foreground text-center"},c?.title,", valable du"," ",u(c?.validFrom)," au"," ",u(c?.validTo),"."),r.createElement(Pe,{className:"mt-2"},r.createElement(P,{onClick:()=>a(!1),variant:"outline",className:"w-fit "},"Fermer")))))}const Xe=function(){const{isLoginOpen:e,isPseudoOpen:t,setIsLoginOpen:a,setIsPseudoOpen:n}=Ke(),{colors:l,isCodePromoOpen:o,setIsCodePromoOpen:i}=w(),{pathname:m}=(0,s.zy)();return r.createElement("div",{className:d("bg-white md:border md:border-border/60 md:shadow-md md:rounded-2xl md:overflow-hidden relative","w-full md:w-[94%] max-w-[1120px] my-6 mx-auto box-border")},r.createElement(c.mg,null,r.createElement("meta",{name:"viewport",content:"width=device-width, user-scalable=no"})),r.createElement("style",null,`\n          :root {\n            --primary: ${l?.primary};\n            --secondary: ${l?.secondary};\n          }\n        `),r.createElement("div",{id:"contestio-layout",className:"relative w-full overflow-hidden"},"/error"!==m&&r.createElement(T,null),r.createElement("div",{className:d("py-5 px-4 md:px-16 w-full")},r.createElement("main",{className:"w-full my-4"},r.createElement(s.sv,null),r.createElement(Te,{open:e,setOpen:a}),r.createElement(Je,{open:t,setOpen:n}),r.createElement(Ge,{open:o,setOpen:i})),r.createElement(H,null))))};var et=a(27933);function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},tt.apply(null,arguments)}const at=r.forwardRef(((e,t)=>{let{className:a,orientation:n="horizontal",decorative:l=!0,...s}=e;return r.createElement(et.b,tt({ref:t,decorative:l,orientation:n,className:d("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a)},s))}));function rt(e){let{withoutButton:t=!1,withoutImage:a=!1,addSeperator:n=!1,addTitle:l=!1}=e;return r.createElement(r.Fragment,null,r.createElement("div",{className:d("w-full h-64 grid grid-cols-12 auto-rows-auto gap-4 items-center bg-white")},r.createElement("div",{className:d("h-full col-span-8",a&&"col-span-12")},l&&r.createElement(k,{className:"w-56 h-10 mb-5"}),r.createElement(k,{className:"w-full h-full"}),!t&&r.createElement(k,{className:"w-44 h-12 mt-4"})),!a&&r.createElement("div",{className:"h-full col-span-4"},r.createElement(k,{className:"m-auto w-5/6 h-4/5 rounded-xl shadow-md"}))),n&&r.createElement("div",{className:"col-span-12 w-3/5 mx-auto"},r.createElement(at,{className:"my-0 w-full"})))}at.displayName=et.b.displayName;const nt=function(){const{navButtons:e}=w(),t=(0,s.Zp)();return(0,r.useEffect)((()=>{var a;e.length>0&&(a=e[0].navUrl,t("contest"===a?"/contests":"survey"===a?"/surveys":"/"))}),[e]),r.createElement("div",{className:"w-full flex flex-col gap-20 my-10 mb-20"},r.createElement(rt,{addSeperator:!0,withoutButton:!0}),r.createElement(rt,null),r.createElement(rt,null),r.createElement(rt,null))},lt=function(e){let{variant:t="default",className:a="",onClick:n,text:l,id:s,isActive:o=!1,disabled:c=!1}=e;return r.createElement(P,{id:s,variant:t,onClick:n,disabled:c,className:d("text-white bg-primary border-2 border-primary rounded-lg shadow-md transition-all duration-300 text-center font-bold","hover:scale-95 hover:shadow-lg hover:bg-primary/90","active:bg-primary/70 active:shadow-sm",o&&"bg-primary/50 text-muted-foreground hover:scale-100",a)},l)},st=function(e){let{datas:t,onClick:a,className:n,isActive:l=!1,variant:s="default",disabled:o=!1}=e;return r.createElement(r.Fragment,null,r.createElement("style",null,t.styles&&`#${t.slug} { ${t.styles} }`,t.hover&&`#${t.slug}:hover { ${t.hover} }`,t.focus&&`#${t.slug}:active { ${t.focus} }`),r.createElement(lt,{id:t.slug,text:t.text,onClick:a,className:n,isActive:l,disabled:o,variant:s}))};function ot(e){let{type:t,description:a,presignedUrl:n,button:l,className:s,title:o,onClick:c,badge:i,textSm:m}=e;return r.createElement(r.Fragment,null,r.createElement("div",{className:d("w-full h-auto grid grid-cols-12 auto-rows-auto gap-4 items-center bg-white",s)},m&&r.createElement("p",{className:"col-span-12 w-full text-sm text-muted-foreground italic"},m),r.createElement("div",{className:d(n?"col-span-8":"col-span-12")},o&&r.createElement("div",{className:"mb-2 flex items-center gap-4"},r.createElement("h2",{className:"text-xl md:text-3xl font-bold"},o),i&&r.createElement("span",{className:"bg-primary w-fit text-white px-4 py-1 rounded-full text-md font-bold"},i)),r.createElement("div",{dangerouslySetInnerHTML:{__html:a},className:d("[&_p]:min-h-6","[&_a]:text-blue-500 [&_a]:underline","[&_ul]:list-disc [&_ul]:pl-10 [&_ul]:space-y-2","[&_ol]:list-decimal [&_ol]:pl-10 [&_ol]:space-y-2","[&_li]:min-h-6","[&_h2]:text-2xl [&_h2]:font-semibold [&_h2]:mb-1","[&_h3]:text-lg [&_h3]:font-semibold [&_h3]:mb-2","[&_strong]:font-bold","[&_em]:italic","[&_span]:font-medium")}),l&&r.createElement(st,{datas:l,className:"mt-4",onClick:()=>c?.(),disabled:l.disabled})),n&&r.createElement("div",{className:"col-span-4"},r.createElement("img",{src:n,alt:"",className:"mx-auto w-5/6 h-auto object-cover rounded-xl shadow-md"}))),("homepage_header"===t||"banner"===t)&&r.createElement("div",{className:"col-span-12 w-3/5 mx-auto"},r.createElement(at,{className:"my-0 w-full"})))}function ct(){return r.createElement("div",{className:"flex flex-col items-center justify-center h-full min-h-56 border rounded-xl p-4 mb-5 shadow-md"},r.createElement("h1",{className:"text-2xl font-bold"},"Aucune actualité trouvée"),r.createElement("p",{className:"text-sm text-gray-500"},"Désolé, aucune actualité n'est disponible pour le moment."))}function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},it.apply(null,arguments)}const mt=function(){const[e,t]=(0,r.useState)(!0),[a,n]=(0,r.useState)([]);(0,r.useEffect)((()=>{l()}),[]);const l=async()=>{try{const{data:e}=await h("v1/org/homepage");n(e.filter((e=>"homepage_other"===e.type)))}catch(e){console.error("Erreur de fetch:",e)}finally{t(!1)}};return e?r.createElement("section",{className:"flex flex-col items-center justify-center my-10 py-10 "},r.createElement(rt,{withoutImage:!0})):r.createElement("section",{className:"flex flex-col items-center justify-center"},0===a.length?r.createElement(ct,null):a.map(((e,t)=>r.createElement(ot,it({key:t},e,{button:e.buttonParticipate,textSm:`Publiée le ${u(e.createdAt)}`,className:"my-5 border border-border p-7 rounded-xl shadow-lg"})))))};function dt(){const{search:e}=(0,s.zy)(),t=e.includes("auth=true"),a=`https://contestio.fr/report-bug?url=${window.location.href}&version=${B}`;return r.createElement("div",{className:"mx-auto my-10 max-w-xl flex flex-col items-center justify-center p-5 border border-border/60 rounded-2xl shadow-md"},r.createElement("h2",{className:"text-xl font-bold mb-1"},t?"Erreur de connexion":"Erreur du serveur"),r.createElement("p",{className:"text-sm text-muted-foreground text-center"},t?"Les clés d'authentification ne sont pas valides. Veuillez contacter le support.":"Une erreur est survenue lors du chargement de la page."),r.createElement(D,{href:a,target:"_blank",className:"mt-4 text-blue-500"},"Signaler l'erreur"),r.createElement(D,{href:"/",className:"mt-4"},"Retourner à l'accueil"))}function ut(){return r.createElement("div",{className:"flex flex-col items-center justify-center h-full min-h-56 border rounded-xl p-4 mb-5 shadow-md"},r.createElement("h1",{className:"text-2xl font-bold"},"Aucun sondage trouvé"),r.createElement("p",{className:"text-sm text-gray-500"},"Désolé, aucun sondage n'est disponible pour le moment."))}var pt=a(72750),ft=a(78719);function gt(){return gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},gt.apply(null,arguments)}const ht=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("textarea",gt({className:d("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t},n))}));function xt(){return xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},xt.apply(null,arguments)}function bt(e){let{survey:t,setSurvey:a,isOpen:n,setIsOpen:l}=e;const{setCodePromo:s,setIsCodePromoOpen:c}=w(),[i,m]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),[f,g]=(0,r.useState)([]),[b,E]=(0,r.useState)(0),{reset:v,watch:N,handleSubmit:y,register:C,setError:O,formState:{errors:j}}=(0,Z.mN)();(0,r.useEffect)((()=>{n?S():(m(!1),v())}),[n]);const S=async()=>{try{const{data:e}=await h(`v1/surveys/${t._id}`);g(e.questions),E(0)}catch(e){if(e instanceof p.pe)return o.oR.error(e.response?.data.message||"Une erreur est survenue"),void(404!==e.response?.status&&400!==e.response?.status||l(!1));o.oR.error("Une erreur est survenue"),console.error(e)}finally{m(!1)}},A=e=>{const t=N(e);return!(!t||""===t)||(O(f[b]?._id,{message:"Vous devez répondre à cette question"}),!1)};return r.createElement("form",{className:"flex flex-col items-center gap-2 py-2",onSubmit:y((async e=>{if(i)return;const r=f.map((t=>({questionId:t._id,answerId:"open"===t.type?null:t.options.find((a=>a.text===e[t._id]))?._id,answer:e[t._id]})));u(!0);try{const{data:e}=await x(`v1/surveys/${t._id}`,{answers:r});a?.({...t,alreadyParticipated:!0}),o.oR.success("Merci !",{description:"Votre participation a été enregistrée."}),l(!1),e.codePromo&&(s(e.codePromo),c(!0))}catch(e){e instanceof p.pe?o.oR.error(e.response?.data.message||"Une erreur est survenue"):(console.error(e),o.oR.error("Une erreur est survenue lors de la participation."))}finally{u(!1)}}))},r.createElement("div",{className:"w-full flex flex-col items-left gap-2 border p-4 rounded-xl"},i?r.createElement("div",{className:"w-full py-10 flex items-center justify-center"},ee({icon:K.A,className:"w-5 h-5 animate-spin"})):r.createElement("div",null,r.createElement("h2",{className:"text-black text-lg !font-medium mb-2"},f[b]?.text),r.createElement("div",{className:"flex flex-col gap-2"},"open"===f[b]?.type?r.createElement(r.Fragment,null,r.createElement(ht,xt({className:"min-h-10 h-10 max-h-32",placeholder:"Votre réponse"},C(f[b]?._id,{required:"Votre réponse est requise",maxLength:200}))),r.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},N(f[b]?._id)?.length||0," / 200")):f[b]?.options.map((e=>r.createElement("div",{key:e._id,className:"w-full flex items-center gap-2"},r.createElement(Ae,xt({type:"radio",id:e._id,value:e.text},C(f[b]?._id,{required:!0}),{className:"!w-4 h-4"})),r.createElement("label",{htmlFor:e._id,className:"w-full hover:bg-primary/10 p-1 rounded-md transition-all duration-300"},e.text)))),j[f[b]?._id]&&r.createElement("p",{className:"w-full text-center font-semibold text-sm text-red-500"},j[f[b]?._id]?.message)))),r.createElement("footer",{className:"mt-5 w-full flex justify-between items-center"},r.createElement(P,{variant:"outline",className:"gap-2",disabled:i||!b,onClick:e=>{e.preventDefault(),0!==b&&E(b-1)}},ee({icon:pt.A,className:"w-5 h-5"}),"Précédent"),i?r.createElement(k,{className:"w-10 h-4"}):r.createElement("p",{className:"text-sm text-muted-foreground"},b+1," / ",f.length),b===f.length-1?r.createElement(P,{type:"submit",className:"gap-2",disabled:i||d,onClick:e=>{A(f[b]?._id)||e.preventDefault()}},"Valider",ee({icon:d?K.A:ft.A,className:"w-5 h-5 "+(d?"animate-spin":"")})):r.createElement(P,{type:"button",className:"gap-2",disabled:i,onClick:e=>{e.preventDefault(),A(f[b]?._id)&&b!==f.length-1&&E(b+1)}},"Suivant",ee({icon:W.A,className:"w-5 h-5"}))))}ht.displayName="Textarea";const Et=()=>{const{user:e}=w(),{setIsLoginOpen:t,setIsPseudoOpen:a}=Ke();return()=>e&&e.firstName?e&&!e.pseudo?(a(!0),!0):!e||!e.pseudo:(t(!0),!0)};function vt(){return vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},vt.apply(null,arguments)}const wt=function(){const e=Et(),[t,a]=(0,r.useState)(!0),[n,l]=(0,r.useState)(!1),[s,o]=(0,r.useState)([]),[c,i]=(0,r.useState)(null);(0,r.useEffect)((()=>{m()}),[]);const m=async()=>{try{const{data:e}=await h("v1/surveys");o(e.filter((e=>"survey"===e.type)))}catch(e){console.error("Erreur de fetch:",e)}finally{a(!1)}};return t?r.createElement("section",{className:"w-full flex flex-col items-start justify-center"},r.createElement("div",{className:"w-full my-5 border border-border p-7 rounded-xl shadow"},r.createElement(k,{className:"h-[40px] w-[60%] rounded-xl mb-2"}),r.createElement(k,{className:"h-[20px] w-[100%] rounded-xl"}),r.createElement(k,{className:"h-[35px] w-[50%] rounded-xl mt-2"})),r.createElement("div",{className:"w-full my-5 border border-border p-7 rounded-xl shadow"},r.createElement(k,{className:"h-[40px] w-[60%] rounded-xl mb-2"}),r.createElement(k,{className:"h-[20px] w-[100%] rounded-xl"}),r.createElement(k,{className:"h-[35px] w-[50%] rounded-xl mt-2"}))):r.createElement("section",{className:"flex flex-col items-center justify-center"},0===s.length?r.createElement(ut,null):s.map((t=>r.createElement(ot,vt({key:t._id,title:t.name},t,{button:{...t.buttonParticipate,text:t.alreadyParticipated?"Déjà participé":t.buttonParticipate.text||"Je participe",disabled:!!t.alreadyParticipated},onClick:()=>{e()||(i(t),l(!0))},className:"my-5 border border-border p-7 rounded-xl shadow",badge:t.alreadyParticipated?"Répondu":void 0})))),r.createElement(Ne,{open:n,onOpenChange:l},r.createElement(Ce,{className:"md:max-w-xl"},r.createElement(Oe,null,r.createElement(je,null,c?.name||"Sondage"),r.createElement(ke,{className:"hidden"},c?.description||"Aucune description")),c?r.createElement(bt,{survey:c,isOpen:n,setIsOpen:l,setSurvey:e=>{o(s.map((t=>t._id===e._id?e:t)))}}):r.createElement("p",null,"Ce sondage n'existe pas."))))};var Nt=a(45154);function yt(){return yt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},yt.apply(null,arguments)}const Ct=J.z.object({pseudo:J.z.string().min(2,{message:"Le pseudo doit contenir au moins 2 caractères."}).max(12,{message:"Le pseudo doit contenir moins de 12 caractères."}).regex(/^[a-zA-Z0-9_]+$/,{message:"Le pseudo ne peut contenir que des lettres, des chiffres et des underscores."})}),Ot=function(){const{user:e,setUser:t}=w(),a=Et(),[n,l]=(0,r.useState)(!1),s=null!==e?.firstName,{watch:c,register:i,setValue:m,handleSubmit:u,formState:{errors:f}}=(0,Z.mN)({resolver:(0,Y.u)(Ct),defaultValues:{pseudo:e?.pseudo||""}}),g=c("pseudo");return(0,r.useEffect)((()=>{s||a()}),[s]),(0,r.useEffect)((()=>{m("pseudo",e?.pseudo||"")}),[e?.pseudo]),r.createElement("section",{className:"flex flex-col items-center justify-center gap-5 my-10"},!s&&r.createElement("div",{className:"flex flex-col gap-2 p-4 border border-border bg-white shadow rounded-xl max-w-sm"},r.createElement("p",{className:"text-lg font-semibold"},"Connectez-vous"),r.createElement("p",{className:"text-sm text-muted-foreground my-5"},"Connectez-vous à votre compte pour modifier votre pseudo et gérer vos notifications."),r.createElement(P,{onClick:a},"Se connecter")),s&&r.createElement(r.Fragment,null,r.createElement("form",{onSubmit:u((async()=>{try{l(!0),await x("pseudo",{pseudo:g}),t({...e,pseudo:g}),o.oR.success(`Bienvenue ${g} !`,{description:"Votre pseudo a bien été modifié."})}catch(e){e instanceof p.pe?o.oR.error(e?.response?.data?.message||"Une erreur est survenue lors de la modification de votre pseudo"):o.oR.error("Une erreur est survenue lors de la modification de votre pseudo")}finally{l(!1)}})),className:"flex flex-col gap-2 p-4 border border-border bg-white shadow rounded-xl max-w-sm"},r.createElement("p",{className:"text-lg font-semibold"},"Modifier votre pseudo"),r.createElement("p",{className:"text-sm text-muted-foreground"},"Votre pseudo est unique et ne peut contenir que des lettres, des chiffres et des underscores."),r.createElement("div",{className:"mt-3 w-full max-w-sm items-center"},r.createElement(Ae,yt({type:"text",id:"pseudo",autoComplete:"off",placeholder:"Votre pseudo",maxLength:12,disabled:n||!s,className:d("border-2 border-primary/50 text-primary font-medium text-center text-lg !h-10","placeholder:text-primary/50",!!f.pseudo?.message&&"border-destructive",n&&"bg-primary/20")},i("pseudo"))),r.createElement("div",{className:"w-full flex justify-end items-center"},r.createElement("span",{className:"text-sm text-muted-foreground"},g?.length," / 12")),f.pseudo&&r.createElement("div",{className:"w-full text-center mt-1"},r.createElement("span",{className:"text-sm text-destructive font-semibold"},f.pseudo.message))),r.createElement("footer",{className:"mt-2 flex !flex-col gap-5 justify-center"},r.createElement(P,{type:"submit",disabled:n||!s,className:"w-fit mx-auto flex items-center gap-2 p-4 text-md rounded-full"},"Valider",ee({icon:n?K.A:qe.A,className:"w-5 h-5 "+(n?"animate-spin":"")})))),r.createElement("div",{className:"flex flex-col gap-2 p-4 border border-border bg-white shadow rounded-xl max-w-sm"},r.createElement("p",{className:"text-lg font-semibold"},"Notifications"),r.createElement("p",{className:"text-sm text-muted-foreground"},"Recevoir les notifications par email : accusé de réception de votre participation, modification de votre classement..."),r.createElement("p",{className:"text-sm text-muted-foreground"},"Actuellement, vous"," ",e?.acceptEmail?"recevez":"ne recevez pas"," les notifications."),r.createElement(P,{variant:"outline",disabled:n||!s,onClick:()=>(async a=>{l(!0);try{await b("v1/users/final/accept-emails",{accept:a}),t({...e,acceptEmail:a})}catch(e){console.error(e)}finally{l(!1)}})(!e?.acceptEmail),className:"w-fit mx-auto flex items-center gap-2"},e?.acceptEmail?"Désactiver":"Activer",ee({icon:n?K.A:e?.acceptEmail?Nt.A:qe.A,className:"w-5 h-5 "+(n?"animate-spin":"")})))))};function Pt(){return r.createElement("div",{className:"flex flex-col items-center justify-center h-full min-h-56 border rounded-xl p-4 mb-5 shadow-md"},r.createElement("h1",{className:"text-2xl font-bold"},"Aucun concours trouvé"),r.createElement("p",{className:"text-sm text-gray-500"},"Désolé, aucun concours n'a été trouvé pour le moment."))}var jt=a(78541);function kt(){return r.createElement("div",{className:"flex flex-col items-start justify-center w-full border border-primary/80 rounded-xl p-4 mb-5 shadow-md shadow-primary/20"},r.createElement("h1",{className:"text-xl text-black font-semibold flex items-center gap-2 mb-2"},"Concours terminé",ee({icon:jt.A,className:"w-4 h-4"})),r.createElement("p",{className:"text-sm text-gray-500"},"Le concours est terminé. Vous ne pouvez plus voter ni modifier votre participation mais vous pouvez toujours voir les participations."))}const St=(0,r.createContext)({contestsLoading:!0,setContestsLoading:()=>{},contestsContent:null,setContestsContent:()=>{},myParticipation:null,setMyParticipation:()=>{},participations:[],setParticipations:()=>{},drawParticipated:!1,setDrawParticipated:()=>{},pagination:{limit:0,page:0,totalPages:0,totalParticipations:0},setPagination:()=>{},increaseTotalParticipations:()=>{},decreaseTotalParticipations:()=>{}}),At=()=>(0,r.useContext)(St),Rt=e=>{let{children:t}=e;const[a,n]=(0,r.useState)(!0),[l,s]=(0,r.useState)(null),[o,c]=(0,r.useState)({limit:0,page:0,totalPages:0,totalParticipations:0}),[i,m]=(0,r.useState)([]),[d,u]=(0,r.useState)(null),[p,f]=(0,r.useState)(!1);return r.createElement(St.Provider,{value:{contestsLoading:a,setContestsLoading:n,contestsContent:l,setContestsContent:s,myParticipation:d,setMyParticipation:u,participations:i,setParticipations:m,pagination:o,setPagination:c,increaseTotalParticipations:()=>{c((e=>({...e,totalParticipations:e.totalParticipations+1})))},decreaseTotalParticipations:()=>{c((e=>({...e,totalParticipations:e.totalParticipations-1})))},drawParticipated:p,setDrawParticipated:f}},t)};var _t=a(5204);function zt(){return zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},zt.apply(null,arguments)}const Lt=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",zt({ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",a)},n))}));Lt.displayName="Card",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",zt({ref:t,className:d("flex flex-col space-y-1.5 p-6",a)},n))})).displayName="CardHeader",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("h3",zt({ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",a)},n))})).displayName="CardTitle",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("p",zt({ref:t,className:d("text-sm text-muted-foreground",a)},n))})).displayName="CardDescription";const It=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",zt({ref:t,className:d("p-3 md:p-6 pt-0 md:pt-0",a)},n))}));It.displayName="CardContent";const Ut=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",zt({ref:t,className:d("flex items-center p-3 md:p-6 pt-0 md:pt-0",a)},n))}));function Ft(){return r.createElement(r.Fragment,null,r.createElement("span",null),r.createElement(Lt,{className:d("border-border/30 shadow-lg overflow-hidden","hover:shadow-2xl hover:border-border transition-all duration-300")},r.createElement(It,{className:"pt-5 relative"},r.createElement("div",{className:"overflow-hidden rounded-xl"},r.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/podium.svg",alt:"No participants",className:d("w-full h-auto aspect-square rounded-xl shadow object-contain","transition-transform duration-300 hover:scale-110")}))),r.createElement(Ut,{className:"flex flex-col gap-0"},r.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},r.createElement("p",{className:"font-medium text-md"},"Aucune participation trouvée !")),r.createElement("p",{className:"w-full font-medium text-md text-muted-foreground"},"Soyez le premier à participer à ce concours !")),r.createElement("span",null)))}Ut.displayName="CardFooter";var Mt=a(12851),$t=a(69047),Vt=a(14320);function Tt(e){let{loading:t,sort:a,sortBy:n,setSort:l,setSortBy:s,changeSort:o}=e;const[c,i]=(0,r.useState)(!1),[m,d]=(0,r.useState)(a.current||"asc"),[u,p]=(0,r.useState)(n.current||"likes");return r.createElement(Ne,{open:c,onOpenChange:i},t?r.createElement(k,{className:"w-[130px] h-10"}):r.createElement(ye,{variant:"ghost",className:"gap-2",disabled:t},"Trier par",ee({icon:$t.A,className:"w-4 h-4 md:w-5 md:h-5"})),r.createElement(Ce,{className:"md:max-w-sm"},r.createElement(Oe,null,r.createElement(je,null,"Trier par"),r.createElement(ke,null,"Vous pouvez trier les participants par popularité ou par date de participation.")),r.createElement("div",{className:"flex flex-col gap-4 "},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(Ae,{type:"radio",id:"populars",name:"sortBy",value:"populars",className:"!w-4 h-4",defaultChecked:"likes"===n.current&&"desc"===a.current,onChange:()=>{p("likes"),d("desc")}}),r.createElement("label",{htmlFor:"populars",className:"flex items-center gap-2"},"Les plus populaires",ee({icon:Vt.A,className:"w-5 h-5"}))),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(Ae,{type:"radio",id:"unpopulars",name:"sortBy",value:"unpopulars",className:"!w-4 h-4",defaultChecked:"likes"===n.current&&"asc"===a.current,onChange:()=>{p("likes"),d("asc")}}),r.createElement("label",{htmlFor:"unpopulars"},"Les moins populaires")),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(Ae,{type:"radio",id:"recents",name:"sortBy",value:"recents",className:"!w-4 h-4",defaultChecked:"createdAt"===n.current&&"desc"===a.current,onChange:()=>{p("createdAt"),d("desc")}}),r.createElement("label",{htmlFor:"recents",className:"flex items-center gap-2"},"Les plus récents")),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(Ae,{type:"radio",id:"oldest",name:"sortBy",value:"oldest",className:"!w-4 h-4",defaultChecked:"createdAt"===n.current&&"asc"===a.current,onChange:()=>{p("createdAt"),d("asc")}}),r.createElement("label",{htmlFor:"oldest"},"Les plus anciens"))),r.createElement(Pe,null,r.createElement(P,{onClick:()=>{l(m),s(u),i(!1),o()},type:"button"},"Valider"))))}function qt(e){let{loading:t,participations:a,totalParticipations:n,search:l,setSearch:s,changeSort:o,sort:c,sortBy:i,setSort:m,setSortBy:d,resetSearch:u}=e;const p=(0,r.useRef)(0),f=(0,r.useRef)(null),g=(0,r.useRef)("");return(0,r.useEffect)((()=>{const e=Date.now();p.current=e,f.current&&clearTimeout(f.current),f.current=setTimeout((()=>{e===p.current&&l!==g.current&&(g.current=l,o())}),800)}),[l,o]),r.createElement("div",{className:"w-full flex flex-col md:flex-row justify-between items-center gap-2 md:gap-5 my-3 md:my-10"},t&&0===a.length?r.createElement(k,{className:"hidden md:block w-40 h-10 rounded-xl"}):r.createElement("p",{className:"hidden md:block font-medium text-md text-muted-foreground"},n," participation",n>1&&"s"),r.createElement("div",{className:"mx-auto flex w-full md:w-2/5 items-center space-x-2 h-9 md:h-10"},t&&0===a.length?r.createElement(k,{className:"w-full h-full"}):r.createElement("div",{className:"relative w-full h-full"},r.createElement(Ae,{type:"text",placeholder:"Rechercher un participant",className:"min-h-9 md:min-h-10 !h-full",value:l||"",maxLength:30,onChange:e=>s(e.target.value)}),l&&l.length>0&&r.createElement(P,{type:"button",variant:"link",className:"h-full aspect-square absolute right-0 top-0",onClick:u},ee({icon:Q.A,className:"w-4 h-4 md:w-5 md:h-5"}))),r.createElement(P,{type:"submit",className:"m-2 h-full w-auto aspect-square bg-primary hover:bg-primary/90",disabled:t,onClick:o},ee({icon:t?K.A:Mt.A,className:"w-5 h-5 "+(t?"animate-spin":"")}))),r.createElement("div",{className:"w-full md:w-fit flex flex-row justify-between items-center gap-2 md:gap-0"},t&&0===a.length?r.createElement(k,{className:"md:hidden w-32 h-6 rounded-xl"}):r.createElement("p",{className:"md:hidden w-full font-medium text-md text-muted-foreground"},n," participation",n>1&&"s"),r.createElement(Tt,{loading:t&&0===a.length,sort:c,sortBy:i,setSort:m,setSortBy:d,changeSort:o})))}function Dt(){return r.createElement(Lt,{className:d("border-border/30 shadow cursor-pointer","hover:shadow-md hover:border-border transition-all duration-300")},r.createElement(It,{className:"!pt-5"},r.createElement(k,{className:"w-full h-auto aspect-square rounded-xl"})),r.createElement(Ut,{className:"flex flex-col gap-2"},r.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},r.createElement(k,{className:"w-44 h-5 rounded-xl"}),r.createElement(k,{className:"w-12 h-6 rounded-xl"})),r.createElement(k,{className:"w-full h-5 rounded-xl"})))}function Bt(){return r.createElement(r.Fragment,null,r.createElement("span",null),r.createElement(Lt,{className:d("border-border/30 shadow-lg overflow-hidden","hover:shadow-2xl hover:border-border transition-all duration-300")},r.createElement(It,{className:"pt-5 relative"},r.createElement("div",{className:"overflow-hidden rounded-xl"},r.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/notFound.svg",alt:"Not found",className:d("w-full h-auto aspect-square rounded-xl shadow","transition-transform duration-300 hover:scale-110")}))),r.createElement(Ut,{className:"flex flex-col gap-0"},r.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},r.createElement("p",{className:"font-medium text-md"},"Aucun utilisateur trouvé !")),r.createElement("p",{className:"w-full font-medium text-md text-muted-foreground"},"Vérifiez que le pseudo est correct et essayez de nouveau...")),r.createElement("span",null)))}var Ht=a(22869);function Jt(e){let{onFileChange:t}=e;return V()?r.createElement("div",{className:"w-full flex justify-center"},r.createElement("label",{htmlFor:"file-upload-mobile",className:"mt-2 inline-block bg-blue-500 text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-600 transition-colors"},"Choisir une image"),r.createElement("input",{id:"file-upload-mobile",type:"file",accept:"image/*",onChange:e=>{const a=e.target.files?.[0];a&&t(a)},className:"hidden"})):r.createElement("div",{className:"mt-3 mb-5 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-gray-400 transition-colors",onDrop:e=>{e.preventDefault();const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")&&t(a)},onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("border-blue-500","bg-blue-50")},onDragLeave:e=>{e.currentTarget.classList.remove("border-blue-500","bg-blue-50")}},r.createElement("p",{className:"text-gray-500 mb-2"},"Glissez et déposez votre image ici"),r.createElement("p",{className:"text-sm text-gray-400"},"ou"),r.createElement("label",{htmlFor:"file-upload",className:"mt-2 inline-block bg-blue-500 text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-600 transition-colors"},"Sélectionnez un fichier"),r.createElement("input",{id:"file-upload",type:"file",accept:"image/*",onChange:e=>{const a=e.target.files?.[0];a&&t(a)},className:"hidden"}))}function Zt(){return Zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Zt.apply(null,arguments)}const Kt=J.z.object({comment:J.z.string().max(255),terms:J.z.boolean().refine((e=>!0===e),{message:"Vous devez accepter les règles du concours"})});function Wt(e){let{isOpen:t,setIsOpen:a,settlementUrl:n}=e;const{setCodePromo:l,setIsCodePromoOpen:s}=w(),{contestsContent:c,setMyParticipation:i,participations:m,setParticipations:u,increaseTotalParticipations:p}=At(),f=(0,r.useRef)(null),g=c?.contest?._id,[h,b]=(0,r.useState)(),[E,v]=(0,r.useState)(""),[N,y]=(0,r.useState)(!1),[C,O]=(0,r.useState)(!1),[j,k]=(0,r.useState)(),{watch:S,reset:A,register:R,handleSubmit:_,formState:{errors:z}}=(0,Z.mN)({resolver:(0,Y.u)(Kt)});(0,r.useEffect)((()=>{A(),v(""),k(void 0),O(!1),y(!1)}),[t]);const L=S("comment");return r.createElement(Ne,{open:t,onOpenChange:a},r.createElement(Ce,{className:"md:w-[60vw] md:max-w-[800px]"},r.createElement(Oe,null,r.createElement(je,null,"Nouvelle participation"),r.createElement(ke,null,"Vous pouvez participer au concours avec une photo de votre choix.")),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-10 auto-rows-auto gap-5"},r.createElement("div",{className:"md:col-span-4 flex flex-col gap-4 justify-center items-center"},r.createElement("div",{className:"w-full max-w-[400px] flex flex-col gap-4"},N&&r.createElement("div",{className:"h-32 md:h-56 flex flex-col gap-2 justify-center items-center border border-border shadow p-4 mx-3 md:mx-auto  rounded-md"},r.createElement("p",null,"Vérification de l'image"),ee({icon:K.A,className:"w-7 h-7 animate-spin text-primary"})),!N&&!E&&r.createElement(Jt,{onFileChange:async e=>{if(e){b(void 0);try{y(!0);const t=new FormData;t.append("file",e,e.name);const{data:a}=await x(`v1/participation/check-image/${g}`,t,{"Content-Type":"multipart/form-data"}),r=new Image;r.src="data:application/octet-stream;base64,"+a,r.onload=function(){v(r.src)},r.onerror=()=>{v(""),o.oR.error("Une erreur est survenue lors de la vérification de l'image")}}catch(e){console.error(e),o.oR.error("Une erreur est survenue lors de la vérification de l'image")}finally{y(!1)}}else v("")}}),!N&&!!E&&r.createElement("div",{className:"flex flex-col gap-2 justify-center items-center border border-border shadow pb-2 mx-3 md:mx-auto rounded-md"},r.createElement(Ht.Ay,{crop:h,onChange:(e,t)=>b(t),onComplete:e=>k(e),aspect:1,minHeight:100,className:"w-fit h-auto mx-auto mt-4 md:mt-0"},r.createElement("img",{ref:f,alt:"Crop me",src:E,className:"w-full h-full object-contain !max-h-[30vh] md:!max-w-[400px] md:!max-h-[400px]",onLoad:e=>{const{width:t,height:a}=e.currentTarget;var r,n;b((r=t,n=a,(0,Ht.ge)((0,Ht.dS)({unit:"%",width:90},1,r,n),r,n)))}})),r.createElement(P,{onClick:()=>v(""),variant:"outline",className:"w-fit gap-2"},"Changer d'image",ee({icon:Q.A,className:"w-5 h-5"}))))),r.createElement("form",{className:"bg-white md:col-span-6 flex flex-col justify-around items-center gap-2 md:border border-border md:shadow p-3 md:p-5 rounded-md",onSubmit:_((async()=>{const e=await(async()=>{const e=document.createElement("canvas"),t=e.getContext("2d");if(!j)return console.error("No crop selected"),null;if(!f.current)return console.error("No image loaded"),null;if(!t)return console.error("Failed to get canvas context"),null;const a=f.current.naturalWidth/f.current.width,r=f.current.naturalHeight/f.current.height,n=window.devicePixelRatio;e.width=Math.floor(j.width*a*n),e.height=Math.floor(j.height*r*n),t.scale(n,n),t.imageSmoothingQuality="high";const l=j.x*a,s=j.y*r;return t.drawImage(f.current,l,s,j.width*a,j.height*r,0,0,j.width*a,j.height*r),new Promise((t=>{e.toBlob((e=>{t(e)}),"image/webp")}))})();if(e)try{O(!0);const t=new FormData;t.append("file",e,"image.webp");const{data:r,status:n}=await x(`v1/participation/upload-image/${g}`,t,{"Content-Type":"multipart/form-data"});if(200!==n&&201!==n)throw o.oR.error("Une erreur est survenue lors du téléchargement de votre image"),new Error("Failed to upload image");const{data:c}=await x(`v1/participation/${g}`,{imageUrl:r.Key,description:L});if(!c)return void o.oR.error("Une erreur est survenue lors de la participation");i(c),u([...m,c]),p(),o.oR.success("Participation ajoutée avec succès !"),a(!1),c?.codePromo&&(l(c.codePromo),s(!0))}catch(e){console.error(e)}finally{O(!1)}else o.oR.error("Ajoutez une image et sélectionnez la zone de recadrage.")}))},r.createElement("div",{className:"w-full flex flex-col gap-2 md:my-4"},r.createElement(ht,Zt({placeholder:"Ajouter une description (facultatif)",maxLength:200,className:"max-h-40"},R("comment"))),r.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},L?.length||0," / 200")),r.createElement("div",{className:"flex items-center justify-center gap-2"},r.createElement("input",Zt({type:"checkbox",id:"terms"},R("terms"),{className:d("peer",z.terms&&"border-destructive text-destructive")})),r.createElement("label",{htmlFor:"terms",className:d("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",z.terms&&"text-destructive")},"J'ai lu et j'accepte"," ",r.createElement("a",{href:n,target:"_blank",className:"underline",rel:"noreferrer"},"les règles du concours"),".")),r.createElement(P,{type:"submit",className:"mt-4 w-full gap-2",disabled:C},"Participer au concours"," ",ee({icon:C?K.A:ft.A,className:"w-5 h-5 "+(C?"animate-spin":"")}))))))}var Yt=a(75779),Qt=a(73072),Gt=a(21749),Xt=a(26777),ea=a(11813),ta=a(32892);function aa(){return aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},aa.apply(null,arguments)}const ra=Xt.bL,na=(Xt.YJ,Xt.WT),la=r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(Xt.l9,aa({ref:t,className:d("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},l),n,r.createElement(Xt.In,{asChild:!0},ee({icon:ea.A,className:"h-4 w-4 opacity-50"})))}));la.displayName=Xt.l9.displayName;const sa=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(Xt.PP,aa({ref:t,className:d("flex cursor-default items-center justify-center py-1",a)},n),ee({icon:ta.A,className:"h-4 w-4"}))}));sa.displayName=Xt.PP.displayName;const oa=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(Xt.wn,aa({ref:t,className:d("flex cursor-default items-center justify-center py-1",a)},n),ee({icon:ea.A,className:"h-4 w-4"}))}));oa.displayName=Xt.wn.displayName;const ca=r.forwardRef(((e,t)=>{let{className:a,children:n,position:l="popper",...s}=e;return r.createElement(Xt.ZL,null,r.createElement(Xt.UC,aa({ref:t,className:d("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l},s),r.createElement(sa,null),r.createElement(Xt.LM,{className:d("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]")},n),r.createElement(oa,null)))}));ca.displayName=Xt.UC.displayName,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(Xt.JU,aa({ref:t,className:d("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},n))})).displayName=Xt.JU.displayName;const ia=r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(Xt.q7,aa({ref:t,className:d("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 hover:bg-primary/10",a)},l),r.createElement("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},r.createElement(Xt.VF,null,ee({icon:ft.A,className:"h-4 w-4"}))),r.createElement(Xt.p4,null,n))}));ia.displayName=Xt.q7.displayName,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(Xt.wv,aa({ref:t,className:d("-mx-1 my-1 h-px bg-muted",a)},n))})).displayName=Xt.wv.displayName;const ma=["Contenu inapproprié","Publicité ou spam","Discours haineux","Usurpation d’identité","Autre"];function da(e){let{pseudo:t,_id:a}=e;const[n,l]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null),[i,m]=(0,r.useState)(null),[d,u]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[h,b]=(0,r.useState)(!1),E=(0,r.useRef)(null);return(0,r.useEffect)((()=>{n||(c(null),m(null),u(!1),b(!1),g(!1))}),[n]),(0,r.useEffect)((()=>{s?("Autre"===s&&E.current?.focus(),ma.includes(s)&&"Autre"!==s?u(!0):u(!("Autre"!==s||!i))):u(!1)}),[s,i]),r.createElement(Ne,{open:n,onOpenChange:l},r.createElement(F,null,r.createElement(M,{className:"ml-auto",asChild:!0},r.createElement(ye,{variant:"ghost-destructive",className:"w-10 h-10 p-0 text-black hover:text-destructive transition-all duration-300"},ee({icon:Gt.A,fill:"black",className:"w-6 h-6 "}))),r.createElement($,{className:"bg-white text-black"},r.createElement("p",null,"Signaler"))),r.createElement(Ce,null,r.createElement(Oe,null,r.createElement(je,null,"Signaler"),r.createElement(ke,null,"Vous êtes sur le point de signaler la participation de"," ",r.createElement("strong",null,t),".")),r.createElement("div",{className:"flex flex-col gap-4"},r.createElement("p",null,"Sélectionnez le motif de votre signalement :"),r.createElement(ra,{onValueChange:e=>c(e)},r.createElement(la,null,r.createElement(na,{placeholder:"Motif"})),r.createElement(ca,null,ma.map((e=>r.createElement(ia,{key:e,value:e,className:"font-normal text-md"},e))))),"Autre"===s&&r.createElement("div",{className:"flex flex-col gap-2 z-[55]"},r.createElement(ht,{ref:E,className:"max-h-40",onChange:e=>m(e.target.value),placeholder:"Ajoutez un commentaire",maxLength:255},i),r.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},i?.length||0," / 255"))),r.createElement(Pe,null,r.createElement(P,{onClick:()=>l(!1),variant:"outline"},"Annuler"),r.createElement(P,{onClick:async()=>{if(d&&!f){g(!0);try{await x(`v1/participation/flag/${a}`,{description:"Autre"===s?i:s}),o.oR.success("Signalement envoyé avec succès !",{description:"Merci pour votre contribution à l'équité du concours."}),l(!1)}catch(e){e instanceof p.pe?o.oR.error(e.response?.data.message||"Une erreur est survenue"):(console.error(e),o.oR.error("Une erreur est survenue lors du signalement."))}finally{g(!1)}}},disabled:!d||f||h,variant:"destructive",className:"flex items-center gap-2"},h?"Signalement envoyé":"Signaler",ee({icon:h?ft.A:f?K.A:Gt.A,className:"size-4 "+(f?"animate-spin":"")})))))}var ua=a(64184),pa=a(66822);function fa(e){let{open:t,setOpen:a,contestId:n,setEditModal:l}=e;const{setMyParticipation:s,participations:c,setParticipations:i,decreaseTotalParticipations:m}=At(),{user:d}=w(),[u,p]=(0,r.useState)(!1);return r.createElement(Ne,{open:t,onOpenChange:e=>{a(e),l(!e)}},r.createElement(Ce,{className:"md:max-w-sm"},r.createElement(Oe,null,r.createElement(je,null,"Suppression de la participation"),r.createElement(ke,null,"Vous êtes sur le point de supprimer votre participation. Cette action est ",r.createElement("strong",null,"irréversible"),".")),r.createElement(Pe,null,r.createElement(P,{type:"button",variant:"outline",onClick:()=>{a(!1),l(!0)},disabled:u,className:"gap-2"},"Annuler"),r.createElement(P,{variant:"destructive",onClick:async()=>{if(!u){p(!0);try{await(async e=>await f.A.delete(g+e))(`v1/participation/${n}`),s?.(null),o.oR.success("Votre participation a bien été supprimée."),i(c.filter((e=>e.pseudo!==d?.pseudo))),a(!1),l(!1),m()}catch(e){e instanceof Error?"Not found"===e.message&&(o.oR.error("Cette participation n'existe pas."),a(!1),l(!0)):(console.error(e),o.oR.error("Une erreur est survenue lors de la suppression."))}finally{p(!1)}}},disabled:u,className:"gap-2"},"Supprimer",ee({icon:u?K.A:pa.A,className:"w-5 h-5 "+(u?"animate-spin":"")})))))}function ga(){return ga=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ga.apply(null,arguments)}const ha=J.z.object({comment:J.z.string().max(200,"La description ne peut pas faire plus de 200 caractères.")});function xa(e){let{part:t,contestId:a,contestEnded:n}=e;const{setMyParticipation:l,participations:s,setParticipations:c}=At(),[i,m]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),{watch:g,register:h,handleSubmit:x,reset:E,formState:{errors:v}}=(0,Z.mN)({resolver:(0,Y.u)(ha),defaultValues:{comment:t.description||""}}),w=g("comment");return(0,r.useEffect)((()=>{d||(m(!1),E())}),[d]),r.createElement(r.Fragment,null,r.createElement(Ne,{open:d,onOpenChange:u},r.createElement(ye,{className:"gap-2 w-full rounded-full",disabled:i||n},n?"Terminé":r.createElement(r.Fragment,null,"Modifier ",ee({icon:ua.A,className:"w-5 h-5"}))),r.createElement(Ce,{className:"md:max-w-sm"},r.createElement(Oe,null,r.createElement(je,null,"Modifier la participation"),r.createElement(ke,null,"Vous pouvez ",r.createElement("strong",null,"supprimer")," ou"," ",r.createElement("strong",null,"modifier la description")," de votre participation à tout moment.")),r.createElement("form",{className:"flex flex-col items-center gap-2 ",onSubmit:x((async()=>{if(!i){m(!0);try{await b(`v1/participation/${a}`,{description:w}),l?.({...t,description:w}),o.oR.success("Participation modifiée avec succès"),c(s.map((e=>e._id===t._id?{...e,description:w}:e))),u(!1)}catch(e){e instanceof Error?"Not found"===e.message&&(o.oR.error("Cette participation n'existe pas."),u(!1)):(console.error(e),o.oR.error("Une erreur est survenue lors de la modification."))}finally{m(!1)}}}))},r.createElement("div",{className:"w-full flex flex-col gap-2 my-4"},r.createElement(ht,ga({placeholder:"Ajouter une description (facultatif)",maxLength:200,className:"max-h-40"},h("comment"))),r.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},w?.length||0," / 200"),v.comment&&r.createElement("p",{className:"text-sm text-destructive text-center"},v.comment.message)),r.createElement(P,{type:"button",variant:"destructive",className:"w-full gap-2",onClick:()=>{u(!1),f(!0)}},"Supprimer la participation",ee({icon:pa.A,className:"w-5 h-5"})),r.createElement(P,{type:"submit",className:"mt-4 w-full gap-2",disabled:i},"Modifier la participation"," ",ee({icon:i?K.A:ua.A,className:"w-5 h-5 "+(i?"animate-spin":"")}))))),r.createElement(fa,{open:p,setOpen:f,contestId:a,setEditModal:u}))}function ba(e){let{objectId:t,image:a,name:n,url:l,type:s="share",isRounded:c=!1,setReportOpen:i}=e;return r.createElement(F,null,r.createElement(M,{className:"report"===s?"ml-auto":"",asChild:!0},r.createElement(P,{variant:"report"===s?"ghost-destructive":"ghost",className:d("w-10 h-10 p-0","report"===s&&"text-black hover:text-destructive transition-all duration-300"),onClick:async()=>{"report"===s&&i?i(!0):("share"===s?window.open(l,"_blank"):"copy"===s&&(navigator.clipboard.writeText(l),o.oR.success("Lien copié avec succès !")),x("v1/activity/final-user",{objectId:t,platform:"copy"===s?"clipboard":n?.toLowerCase()||"unknown",action:"contest-sharing"}).catch((e=>{console.error(e)})))}},"string"==typeof a?r.createElement("img",{src:a,alt:n||s,className:d("w-6 h-6",c?"rounded-full":"rounded-md")}):ee({icon:a,fill:"black",className:"w-6 h-6 "}))),r.createElement($,{className:"bg-white text-black"},"share"===s?r.createElement("p",null,"Partager sur ",r.createElement("strong",null,n)):"copy"===s?r.createElement("p",null,"Copier le lien"):"report"===s&&r.createElement("p",null,"Signaler")))}function Ea(e){let{part:t,contestEnded:a,votedToday:n=!1,isMyParticipation:l=!1}=e;const s=Et(),{contestsContent:c,participations:i,setParticipations:m,setMyParticipation:u}=At(),f=c?.contest?._id,[g,h]=(0,r.useState)(!1),[b,E]=(0,r.useState)(!1),v=`${window.location.href.replace(/\?.*$/,"")}?ctst-u=${t.pseudo}`,w=encodeURIComponent(v),N=!1===t.isActive&&!!t.moderationStatus,y=t.liked||!0===n||g||a||N;return r.createElement("div",{className:d("bg-white my-5 md:my-0 mx-auto grid grid-cols-1 md:grid-cols-2 gap-5 items-center auto-rows-auto after:content-none max-w-full md:max-w-[800px]",l&&"border border-border rounded-xl py-5 px-7 shadow",N&&"relative")},r.createElement("img",{src:t.presignedUrl||"",alt:t.pseudo||"Image",className:d("mx-auto w-2/3 md:w-full h-auto aspect-square rounded-xl shadow-xl","transition-transform duration-300 hover:scale-105")}),r.createElement("div",{className:"w-full h-full px-4 flex flex-col justify-between"},r.createElement("p",{className:"font-medium text-lg text-center"},l?"Ma participation : ":"Participation de ",r.createElement("span",{className:"font-bold"},t.pseudo||"")),r.createElement("p",{className:"text-muted-foreground text-sm text-center p-4 border border-border/60 rounded-md my-5 break-words"},t.description||r.createElement("span",{className:"italic"},"Aucune description ajoutée.")),r.createElement("div",{className:"my-5 mx-auto w-2/3 flex flex-col gap-5 items-center justify-between"},r.createElement("div",{className:"w-full flex flex-row gap-1 items-center justify-between"},r.createElement("div",{className:"flex flex-row gap-2 items-center"},ee({icon:Yt.A,filledRed:t.liked||l,className:`w-5 h-5 ${(t.liked||l)&&"text-red-500"}`}),t.likes||0),r.createElement("div",{className:"flex flex-row gap-2 items-center"},t.rank||0," ",1===t.rank?"er":"ème",ee({icon:1===t.rank?jt.A:Qt.A,className:"w-5 h-5 "+(1===t.rank?"text-yellow-400":"text-muted-foreground")}))),l&&f&&!N?r.createElement(xa,{contestId:f,part:t,setMyParticipation:u,contestEnded:a,participations:i,setParticipations:m}):r.createElement(P,{className:"w-full rounded-full gap-2 relative",disabled:y||g,onClick:()=>{s()||(async()=>{h(!0);try{await x(`v1/participation/like/${t._id}`,{}),t.likes=t.likes+1,t.liked=!0,o.oR.success("Vote ajouté avec succès !"),E(!0)}catch(e){e instanceof p.pe?o.oR.error(e.response?.data.message||"Une erreur est survenue"):(console.error(e),o.oR.error("Une erreur est survenue lors de l'ajout du vote."))}finally{h(!1)}})()}},t.liked?"Vote ajouté":n?"Déjà voté aujourd'hui":a?"Terminé":"Voter",b&&r.createElement("div",{className:"absolute top-0 left-0 w-full h-10 flex items-center justify-center"},r.createElement(De.A,{zIndex:50,force:.4,particleCount:30,width:300,onComplete:()=>E(!1)})),ee({icon:g?K.A:Yt.A,fill:"white",className:`w-5 h-5 text-white ${!1===y&&"animate-hi-there"} ${g&&"animate-spin"}`}))),r.createElement("footer",null,r.createElement("div",null,r.createElement("p",{className:"w-full font-light text-sm text-muted-foreground"},"Partager sur :"),r.createElement("div",null,r.createElement("div",{className:"flex flex-row gap-2 items-center"},ba({objectId:t._id,image:"/skin/frontend/base/default/reactjs-app/images/facebook.png",name:"Facebook",url:`https://www.facebook.com/sharer/sharer.php?u=${w}`,type:"share"}),ba({objectId:t._id,image:"/skin/frontend/base/default/reactjs-app/images/twitter.webp",name:"Twitter",url:`https://twitter.com/intent/tweet?url=${w}`,type:"share",isRounded:!0}),ba({objectId:t._id,image:"/skin/frontend/base/default/reactjs-app/images/messenger.png",name:"Messenger",url:`https://www.messenger.com/send?text=${w}`,type:"share"}),ba({objectId:t._id,image:Qe.A,url:v,type:"copy"}),!l&&!a&&r.createElement(da,{pseudo:t.pseudo,_id:t._id})))))),N&&r.createElement("div",{className:"absolute inset-0 bg-white/80 z-50 flex items-center justify-center rounded-xl backdrop-blur"},r.createElement("div",{className:"bg-white border rounded-xl shadow w-3/4 p-5"},r.createElement("h1",{className:"text-xl font-bold mb-2"},"Modération"),r.createElement("p",null,"Cette participation est en cours de modération ou a été supprimée."),r.createElement("p",{className:"mt-4 border p-2 rounded-xl w-full text-center"},t.moderationStatus))))}function va(e){let{part:t,onItemClick:a}=e;return r.createElement(Lt,{onClick:()=>a(t),className:d("border-border/30 cursor-pointer overflow-hidden rounded-xl shadow","hover:shadow-md hover:border-border transition-all duration-300")},r.createElement(It,{className:"pt-3 md:pt-5 relative"},r.createElement("div",{className:"overflow-hidden rounded-md"},r.createElement("img",{src:t.presignedUrl||"",alt:t.pseudo||"Image",className:d("w-full h-auto aspect-square rounded-md shadow","transition-transform duration-300 hover:scale-110")}),t.rank<4&&r.createElement("span",{className:"absolute top-2 md:top-4 right-2 md:right-4 bg-primary text-white px-4 py-1 rounded-full text-sm font-semibold"},t.rank,1===t.rank?"er":" ème"))),r.createElement(Ut,{className:"flex flex-col gap-0 pt-0"},r.createElement("div",{className:"w-full flex flex-row gap-2 justify-between items-center"},r.createElement("p",{className:"font-medium text-md truncate flex-grow"},t.pseudo||""),r.createElement("div",{className:"flex flex-row gap-1 items-center flex-shrink-0"},ee({icon:Yt.A,fill:t.liked?"red-500":"transparent",filledRed:t.liked,className:`w-5 h-5 ${t.liked&&"text-red-500"}`}),t.likes||0)),r.createElement("p",{className:"w-full h-6 line-clamp-1 break-all text-ellipsis font-medium text-md text-muted-foreground"},t.description||"")))}const wa=r.memo((e=>{let{participations:t,onItemClick:a}=e;return r.createElement(r.Fragment,null,t.map((e=>r.createElement(va,{key:e._id,part:e,onItemClick:a}))))}));wa.displayName="PartsList";const Na=wa;function ya(e){let{contestEnded:t,isOpen:a,setIsOpen:n}=e;const s=Et(),{user:o}=w(),{contestsContent:c,myParticipation:i,participations:m,setParticipations:d,pagination:u,setPagination:p}=At(),[f]=(0,l.ok)(),g=(0,r.useRef)(f.get("ctst-q")),x=(0,r.useRef)(f.get("ctst-u")),b=(0,r.useRef)(1),E=(0,r.useRef)("desc"),v=(0,r.useRef)("likes"),[N,y]=(0,r.useState)(x.current?x.current:g.current||""),[C,O]=(0,r.useState)(!0),[j,k]=(0,r.useState)(null),[S,A]=(0,r.useState)(!1);(0,r.useEffect)((()=>{z()}),[c]),(0,r.useEffect)((()=>{x.current=f.get("ctst-u"),f.get("ctst-u")&&(k(null),A(!0))}),[f.get("ctst-u")]),(0,r.useEffect)((()=>{if(!C)if(g.current=N,N.length>0){const e=new URL(window.location.href);e.searchParams.set("ctst-q",N),window.history.pushState({path:e.href},"",e.href)}else R()}),[N]),(0,r.useEffect)((()=>{if(S&&j){const e=new URL(window.location.href);e.searchParams.set("ctst-u",j?.pseudo),window.history.replaceState({path:e.href},"",e.href)}else{const e=new URL(window.location.href);e.searchParams.delete("ctst-u"),window.history.replaceState({path:e.href},"",e.href)}}),[S,j]);const R=()=>{const e=new URL(window.location.href);e.searchParams.delete("ctst-q"),e.searchParams.delete("ctst-u"),window.history.pushState({path:e.href},"",e.href)},_=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return[];O(!0);try{const{data:a}=await h(`v1/contests/${e}/${v.current}/${E.current}/${b.current}?search=${t?"":N}`);return p({limit:a.limit||0,page:a.page||0,totalPages:a.totalPages||0,totalParticipations:a.totalParticipations||0}),N.length>0&&N===x.current&&k(a.participations[0]||null),a.participations||[]}catch(e){console.error("Erreur de fetch:",e)}finally{O(!1)}},z=async()=>{if(!c?.contest?.slug)return;const e=(await _(c?.contest?.slug||"")).filter((e=>!m.some((t=>t._id===e._id))));d([...m,...e]||[])};return r.createElement(r.Fragment,null,i&&r.createElement("div",{className:"mb-5"},r.createElement(Ea,{isMyParticipation:!0,contestEnded:t,part:i})),r.createElement(Wt,{settlementUrl:c?.contest?.settlement||"",isOpen:a,setIsOpen:n}),r.createElement(qt,{loading:C,participations:m,totalParticipations:u.totalParticipations,search:N,setSearch:e=>{y(e)},changeSort:async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O(!0),b.current=1,d([]);const t=await _(c?.contest?.slug||"",e);d(t||[])},sort:E,sortBy:v,setSort:e=>{E.current=e},setSortBy:e=>{v.current=e},resetSearch:()=>{O(!0),y(""),R(),g.current="",x.current=""}}),r.createElement("div",{className:"w-full grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-10 after:content-none"},C&&0===m?.length?r.createElement(r.Fragment,null,r.createElement(Dt,null),r.createElement(Dt,null),r.createElement(Dt,null),r.createElement(Dt,null),r.createElement(Dt,null),r.createElement(Dt,null)):r.createElement(Na,{participations:m,onItemClick:e=>{k(e),A(!0)}}),r.createElement(Ne,{open:S,onOpenChange:A},r.createElement(Ce,{className:"max-w-[700px]"},r.createElement(Oe,{className:"hidden"},r.createElement(je,null,"Participation de ",j?.pseudo||"nc"),r.createElement(ke,null,j?.description||"Aucune description")),j?r.createElement(Ea,{contestEnded:t,part:j,votedToday:c?.votedToday||!1}):C?r.createElement("div",{className:"flex items-center justify-center w-full h-40"},ee({icon:K.A,className:"size-10 text-primary animate-spin"})):r.createElement("p",null,"Cette participation n'existe pas."))),C||0!==m?.length?null:N.length>0?r.createElement(Bt,null):r.createElement(Ft,null),C&&r.createElement(r.Fragment,null,[...Array(u.limit||3)].map(((e,t)=>r.createElement(Dt,{key:t}))))),u.totalPages>1&&b.current<u.totalPages&&r.createElement(P,{variant:"ghost",disabled:C,onClick:()=>{s()||(b.current+=1,z())},className:"flex items-center gap-2 mt-10"},o?.firstName?"Voir plus":"Connectez-vous pour en voir plus",ee(C?{icon:K.A,className:"size-5 animate-spin"}:{icon:_t.A,className:"size-5"})))}function Ca(){return Ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Ca.apply(null,arguments)}const Oa=J.z.object({terms:J.z.boolean().refine((e=>!0===e),{message:"Vous devez accepter les règles du concours"})});function Pa(e){let{isOpen:t,setIsOpen:a,settlementUrl:n}=e;const{setCodePromo:l,setIsCodePromoOpen:s}=w(),{contestsContent:c,setDrawParticipated:i}=At(),m=c?.contest?._id,[u,p]=(0,r.useState)(!1),{reset:f,register:g,handleSubmit:h,formState:{errors:b}}=(0,Z.mN)({resolver:(0,Y.u)(Oa)});return(0,r.useEffect)((()=>{f()}),[t]),r.createElement(Ne,{open:t,onOpenChange:a},r.createElement(Ce,{className:"pb-4 md:p-10 md:max-w-sm"},r.createElement(Oe,null,r.createElement(je,null,"Nouvelle participation"),r.createElement(ke,null,"Ce concours est de type"," ",r.createElement("span",{className:"font-semibold"},"tirage au sort"),". Pour participer, il vous suffit de lire et d'accepter les règles du concours.",r.createElement("br",null),r.createElement("br",null),"Les gagnants seront tirés au sort le lendemain de la fin du concours et seront notifiés par email.")),r.createElement("form",{className:"flex flex-col justify-around items-center gap-2",onSubmit:h((async()=>{try{p(!0);const{data:e}=await x(`v1/participation/draw/${m}`,{});if(!e)return void o.oR.error("Une erreur est survenue lors de la participation");o.oR.success("Participation ajoutée avec succès !"),a(!1),i(!0),e?.codePromo&&(l(e.codePromo),s(!0))}catch(e){console.error(e)}finally{p(!1)}}))},r.createElement("div",{className:"flex items-center justify-center gap-2 my-3"},r.createElement("input",Ca({type:"checkbox",id:"terms"},g("terms"),{className:d("peer",b.terms&&"border-destructive text-destructive")})),r.createElement("label",{htmlFor:"terms",className:d("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",b.terms&&"text-destructive")},"J'ai lu et j'accepte"," ",r.createElement("a",{href:n,target:"_blank",className:"underline",rel:"noreferrer"},"les règles du concours"),".")),r.createElement(P,{type:"submit",className:"mt-4 w-full gap-2",disabled:u},"Participer au concours"," ",ee({icon:u?K.A:jt.A,className:"w-5 h-5 "+(u?"animate-spin":"")})))))}function ja(){return r.createElement("div",{className:"flex flex-col items-start justify-center w-full border-2 border-primary/50 rounded-xl p-4 mb-5 shadow-md shadow-primary/20"},r.createElement("h1",{className:"text-md md:text-xl text-black font-semibold flex items-center gap-2 mb-2"},"Participation au tirage au sort",ee({icon:jt.A,className:"w-4 h-4"})),r.createElement("p",{className:"text-sm text-muted-foreground"},"Vous avez participé au tirage au sort. Vous pouvez désormais attendre le tirage pour voir si vous avez gagné un des lots."))}function ka(e){let{isOpen:t,setIsOpen:a}=e;const{contestsContent:n,drawParticipated:l}=At();return r.createElement(r.Fragment,null,l&&r.createElement(ja,null),r.createElement(Pa,{settlementUrl:n?.contest?.settlement||"",isOpen:t,setIsOpen:a}))}function Sa(){return Sa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Sa.apply(null,arguments)}function Aa(e){let{contestEnded:t}=e;const a=Et(),{contestsContent:n,contestsLoading:l,myParticipation:s,drawParticipated:o}=At(),[c,i]=(0,r.useState)(!1);return r.createElement(r.Fragment,null,l&&r.createElement("div",{className:"w-full flex flex-col gap-20 my-20"},r.createElement(rt,{withoutImage:!0,withoutButton:!0})),!l&&n?.contest&&r.createElement("div",{className:"w-full flex flex-col gap-5 mb-10"},r.createElement(ot,Sa({},t&&{badge:"Terminé"},{type:n.contest.type,title:n.contest.name,description:n.contest.description,button:l||s||t||o?void 0:n.contest.buttonParticipate,onClick:()=>{a()||i(!0)}})),n.contest.gifts&&r.createElement("div",{className:"w-auto max-w-full flex flex-row flex-nowrap gap-5 p-4 items-center overflow-x-auto no-scrollbar"},n.contest.gifts.map((e=>r.createElement("div",{key:e._id,className:"min-w-40 w-auto flex flex-col items-center gap-2 shadow rounded-xl p-3 md:p-5  border border-border/40 hover:border-border hover:bg-accent/20"},r.createElement("span",{className:"text-md font-semibold text-center line-clamp-2 text-ellipsis"},e.name),r.createElement("span",{className:"text-sm text-muted-foreground"},"Valeur de ",e.price," €"),r.createElement("img",{src:e.presignedUrl,alt:e.name,className:"w-auto h-32 object-contain rounded"})))))),t&&r.createElement(kt,null),"ugc"===n?.contest?.contestType&&r.createElement(ya,{contestEnded:t,isOpen:c,setIsOpen:i}),"draw"===n?.contest?.contestType&&r.createElement(ka,{contestEnded:t,isOpen:c,setIsOpen:i}))}const Ra=function(){const{contestsLoading:e,setContestsLoading:t,contestsContent:a,setContestsContent:n,setMyParticipation:l,setDrawParticipated:s}=At(),[o,i]=(0,r.useState)(!1),[m,d]=(0,r.useState)(!1);(0,r.useEffect)((()=>{u()}),[]);const u=async()=>{try{const{data:e}=await h("v1/contests/metadatas");n(e),l(e.myParticipation),s(!!e.drawParticipated),e.contest.name?i(!1):(i(!0),d(!!a?.contest?.ended))}catch(e){console.error("Erreur de fetch:",e)}finally{t(!1)}};return r.createElement("section",{className:"flex flex-col items-center justify-center"},r.createElement(c.mg,null,r.createElement("meta",{property:"og:title",content:`Concours ${a?.contest?.name}`}),r.createElement("meta",{property:"og:description",content:a?.contest?.description}),r.createElement("meta",{property:"og:image",content:a?.banner?.presignedUrl})),!e&&o?r.createElement(Pt,null):r.createElement(Aa,{contestEnded:m}))},_a=function(){const e=window.location.href.includes("contestio")?"/index.php/contestio":"/";return r.createElement(l.Kd,{basename:e},r.createElement(v,null,r.createElement(We,null,r.createElement(o.l$,null),r.createElement(c.vd,null,r.createElement(U,null,r.createElement(Rt,null,r.createElement(s.BV,null,r.createElement(s.qh,{element:r.createElement(Xe,null)},r.createElement(s.qh,{path:"/contests",element:r.createElement(Ra,null)}),r.createElement(s.qh,{path:"/surveys",element:r.createElement(wt,null)}),r.createElement(s.qh,{path:"/profile",element:r.createElement(Ot,null)}),r.createElement(s.qh,{path:"/news",element:r.createElement(mt,null)}),r.createElement(s.qh,{path:"/",element:r.createElement(nt,null)}),r.createElement(s.qh,{path:"/error",element:r.createElement(dt,null)})))))))))};n.createRoot(document.getElementById("root")).render(r.createElement(r.StrictMode,null,r.createElement(_a,null)))}},n={};function l(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(a.exports,a,a.exports,l),a.loaded=!0,a.exports}l.m=r,e=[],l.O=(t,a,r,n)=>{if(!a){var s=1/0;for(m=0;m<e.length;m++){a=e[m][0],r=e[m][1],n=e[m][2];for(var o=!0,c=0;c<a.length;c++)(!1&n||s>=n)&&Object.keys(l.O).every((e=>l.O[e](a[c])))?a.splice(c--,1):(o=!1,n<s&&(s=n));if(o){e.splice(m--,1);var i=r();void 0!==i&&(t=i)}}return t}n=n||0;for(var m=e.length;m>0&&e[m-1][2]>n;m--)e[m]=e[m-1];e[m]=[a,r,n]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var n=Object.create(null);l.r(n);var s={};t=t||[null,a({}),a([]),a(a)];for(var o=2&r&&e;"object"==typeof o&&!~t.indexOf(o);o=a(o))Object.getOwnPropertyNames(o).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,l.d(n,s),n},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={792:0};l.O.j=t=>0===e[t];var t=(t,a)=>{var r,n,s=a[0],o=a[1],c=a[2],i=0;if(s.some((t=>0!==e[t]))){for(r in o)l.o(o,r)&&(l.m[r]=o[r]);if(c)var m=c(l)}for(t&&t(a);i<s.length;i++)n=s[i],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(m)},a=self.webpackChunkcontestio=self.webpackChunkcontestio||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),l.nc=void 0,l.O(void 0,[96],(()=>l(84315))),l.O(void 0,[96],(()=>l(7452)));var s=l.O(void 0,[96],(()=>l(22330)));s=l.O(s)})();