(()=>{"use strict";var e,t,a,r={7509:(e,t,a)=>{var r=a(96540),n=a(5338),l=a(84976),s=a(47767),c=a(64721),o=a(85902);const i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=await fetch(`http://127.0.0.1/index.php/contestio/api/proxy?endpoint=${e}`,{method:t,headers:{"Content-Type":"application/json"},body:a?JSON.stringify(a):void 0});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return 201===r.status||r.json()},m=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=await fetch(`http://127.0.0.1/index.php/contestio/api/proxy?endpoint=${e}`,{method:t,headers:{"Content-Type":"application/json"},body:a?JSON.stringify(a):void 0}),n=r.ok,l=r.status,s=201===l||r.json(),c=r.statusText;if(!n)throw new Error(c);return{isOk:n,status:l,datas:s,message:c}},d=(0,r.createContext)(void 0);function u(e){let{children:t}=e;const[a,n]=(0,r.useState)(!0),[l,s]=(0,r.useState)([]),[c,o]=(0,r.useState)({id:"8",firstName:"ppp",pseudo:"pouiass"}),[m,u]=(0,r.useState)(!0),[p,f]=(0,r.useState)([]),[g,h]=(0,r.useState)(!0),[v,b]=(0,r.useState)(null),[w,x]=(0,r.useState)(0);(0,r.useEffect)((()=>{console.log("Context mounted"),E()}),[]);const E=async()=>{try{const e=await i("v1/org/header");s(e.buttons||[]);const t=e.user||null;null!==t.pseudo&&t.pseudo,Object.values(t).every((e=>null===e||""===e))}catch(e){console.error(e)}finally{n(!1)}};return React.createElement(d.Provider,{value:{counter:w,setCounter:x,incrementCounter:()=>x(w+1),decrementCounter:()=>x(w-1),navButtons:l,user:c,setUser:o,appLoading:a,homepageLoading:m,homepageContent:p,setHomepageLoading:u,setHomepageContent:f,contestsLoading:g,contestsContent:v,setContestsLoading:h,setContestsContent:b}},t)}function p(){const e=(0,r.useContext)(d);if(void 0===e)throw new Error("useAppContext doit être utilisé à l'intérieur d'un AppProvider");return e}var f=a(34164),g=a(50856);function h(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,g.QP)((0,f.$)(t))}var v=a(33362),b=a(80097);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},w.apply(null,arguments)}const x=(0,b.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-contestio-purple text-white hover:bg-contestio-purple/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80 active:bg-destructive/60",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"text-contestio-purple text-md font-medium hover:bg-contestio-purple/10","ghost-destructive":"text-destructive text-md font-medium hover:bg-destructive/10",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),E=r.forwardRef(((e,t)=>{let{className:a,variant:n,size:l,asChild:s=!1,...c}=e;const o=s?v.DX:"button";return r.createElement(o,w({className:h(x({variant:n,size:l,className:a})),ref:t},c))}));function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},R.apply(null,arguments)}function N(e){let{className:t,...a}=e;return React.createElement("div",R({className:h("animate-pulse rounded-md bg-muted",t)},a))}E.displayName="Button";var y=a(35847);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},C.apply(null,arguments)}const k=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(y.bL,C({ref:t,className:h("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a)},n))}));k.displayName=y.bL.displayName;const j=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(y._V,C({ref:t,className:h("aspect-square h-full w-full",a)},n))}));j.displayName=y._V.displayName;const O=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(y.H4,C({ref:t,className:h("flex h-full w-full items-center justify-center rounded-full bg-muted",a)},n))}));O.displayName=y.H4.displayName;var S=a(69067);function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},P.apply(null,arguments)}const A=S.Kq,L=S.bL,_=S.l9,M=r.forwardRef(((e,t)=>{let{className:a,sideOffset:n=4,...l}=e;return r.createElement(S.UC,P({ref:t,sideOffset:n,className:h("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a)},l))}));M.displayName=S.UC.displayName;const z=function(){const{appLoading:e,user:t,setUser:a,navButtons:r}=p(),n=(0,s.Zp)(),l=window.location.pathname.split("/").pop(),c="/"===l||""===l||"contestio"===l,o="contests"===l,i="surveys"===l;return React.createElement("header",{className:"w-full flex flex-col"},React.createElement("div",{className:h("relative flex flex-col gap-5 h-80 w-full bg-cover bg-center",'bg-[url("https://images.pexels.com/photos/270756/pexels-photo-270756.jpeg?cs=srgb&dl=pexels-pixabay-270756.jpg&fm=jpg")]')},React.createElement("div",{className:"bg-gradient-to-br from-black/10 to-black/50 w-full h-full"}),React.createElement("h1",{className:"text-white text-4xl leading-tight font-bold absolute top-4 right-4 w-1/4 drop-shadow-md whitespace-nowrap"},"Bienvenue au ",React.createElement("br",null)," club Cabesto !"),React.createElement("p",{className:"text-white uppercase leading-relaxed font-semibold absolute bottom-8 left-0 right-0 w-full px-8 text-left drop-shadow-md"},"Retrouvez-ici les dernières actualités de Cabesto, participe aux évènements uniques que nous organisons et tente de remporter des lots ou des bons d'achats à faire valoir dans tous nos magasins !!")),React.createElement("nav",{className:"flex justify-between items-center gap-5 border-b border-gray-200 px-16 shadow-md"},React.createElement("div",{className:"flex items-center gap-5 pt-4"},e&&React.createElement(React.Fragment,null,React.createElement(N,{className:"h-[20px] w-[100px] rounded-xl mb-4"}),React.createElement(N,{className:"h-[20px] w-[100px] rounded-xl mb-4"})),r.map((e=>(e=>{const t="contest"===e.navUrl?o:"survey"===e.navUrl?i:c;return React.createElement(E,{key:e.slug,id:e.slug,onClick:()=>{return t=e.navUrl||"",void n("contest"===t?"/contests":"survey"===t?"/surveys":"/");var t},className:h("bg-white text-contestio-purple font-bold border-0 rounded-none border-b-2 pb-5 border-transparent","hover:border-contestio-purple/50 hover:bg-white hover:text-contestio-purple/70","active:border-contestio-purple/80 active:text-contestio-purple/80",t&&"border-contestio-purple hover:border-contestio-purple hover:bg-white hover:text-contestio-purple")},e.text)})(e)))),t&&t.pseudo&&React.createElement(L,null,React.createElement(_,{asChild:!0},React.createElement(E,{variant:"ghost",onClick:()=>n("/profile"),className:h("flex justify-end items-center gap-2 border border-border/70 rounded-md px-2 py-1 shadow","cursor-pointer hover:border-border hover:shadow-md hover:bg-white")},React.createElement("span",{className:"text-md font-normal text-contestio-purple"},t.pseudo),React.createElement(k,{className:"w-7 h-7"},React.createElement(j,{src:t.avatar}),React.createElement(O,{className:"text-muted-foreground font-medium text-sm"},(t.firstName+" "+t.pseudo).split(" ").filter((e=>""!==e)).map((e=>e[0])).join(""))))),React.createElement(M,{className:"bg-white text-black"},React.createElement("p",null,"Voir mon profil")))))};function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},T.apply(null,arguments)}const U=function(e){return React.createElement("a",T({},e,{className:h("text-muted-foreground border-b border-b-transparent no-underline","hover:no-underline hover:border-b-contestio-purple hover:text-contestio-purple transition-all duration-300",e.className)}))},$=function(){const e=`https://contestio.fr/report-bug?url=${window.location.href}&version=0.1.0`;return React.createElement("footer",{className:"w-full my-0 flex justify-end items-center"},React.createElement("div",{className:"flex items-center gap-2 text-sm text-muted-foreground"},React.createElement(U,{href:e,target:"_blank"},"Signaler un bug"),React.createElement("span",{className:"border-b border-b-transparent"},"-"),React.createElement("span",{className:"font-light border-b border-b-transparent"},"Powered by"),React.createElement(U,{href:"https://contestio.fr",target:"_blank"},"Contestio"),React.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/logo.png",alt:"Contestio",height:20,width:20})))};var F=a(14476),q=a(70893),B=a(49785);function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},V.apply(null,arguments)}const I=r.forwardRef(((e,t)=>{let{className:a,type:n,...l}=e;return r.createElement("input",V({type:n,className:h("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-contestio-purple/20 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t},l))}));I.displayName="Input";var H=a(95920);function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},D.apply(null,arguments)}const J=(0,b.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(H.b,D({ref:t,className:h(J(),a)},n))}));Z.displayName=H.b.displayName;var G=a(24082);const K=e=>{let{icon:t,filledRed:a,fill:r,className:n}=e;const l=(0,G.A)(t);return React.createElement("span",{dangerouslySetInnerHTML:{__html:l.outerHTML},className:h("[&_svg]:w-full [&_svg]:h-full",a?"[&_svg]:fill-red-500":r&&`[&_svg]:fill-${r}`,n)})};var W=a(25191),Y=a(40961);const Q=e=>{let{isOpen:t,isClosing:a,children:n,className:l}=e;return t?(0,Y.createPortal)(r.createElement("div",{className:"absolute inset-0 z-10","data-contestio-modal":t?"open":"closed"},r.createElement("div",{className:"absolute inset-0 flex items-center justify-center z-50 backdrop-blur"},r.createElement("div",{className:"absolute inset-0 bg-white/60"}),r.createElement("div",{className:h("relative bg-white min-w-[400px] p-10 rounded-xl z-10 border border-border shadow-xl",a?"animate-fade-out":"animate-fade-in",l)},n))),document.getElementById("contestio-layout")):null},X=e=>{let{onClick:t}=e;return r.createElement("div",{className:"absolute top-4 right-4"},r.createElement(E,{onClick:t,variant:"ghost",className:"size-10 p-0"},K({icon:W.A,className:"size-6"})))},ee=e=>{let{children:t,onClose:a}=e;return r.createElement("div",{className:"flex flex-row justify-between items-center mb-5"},r.createElement("h2",{className:"text-black text-xl font-bold"},t),r.createElement(E,{onClick:a,variant:"ghost",className:"size-10 p-0"},K({icon:W.A,className:"size-6"})))},te=e=>{let{className:t,children:a}=e;return r.createElement("div",{className:h("w-full flex flex-row justify-end gap-5 mt-5",t)},a)};var ae=a(28710),re=a(65550);function ne(){return ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},ne.apply(null,arguments)}const le=(0,r.forwardRef)(((e,t)=>{let{className:a,...n}=e;const[l,s]=(0,r.useState)(!1);return""===n.value||void 0===n.value||n.disabled,React.createElement("div",{className:"relative flex items-center"},React.createElement(I,ne({type:l?"text":"password",className:h("hide-password-toggle pr-10",a),ref:t},n)),React.createElement(E,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-[0] h-full px-3 py-2 hover:bg-transparent",onClick:()=>s((e=>!e))},K({icon:l?ae.A:re.A,className:"h-4 w-4"})),React.createElement("style",null,"\n\t\t\t\t\t.hide-password-toggle::-ms-reveal,\n\t\t\t\t\t.hide-password-toggle::-ms-clear {\n\t\t\t\t\t\tvisibility: hidden;\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\tdisplay: none;\n\t\t\t\t\t}\n          "))}));le.displayName="PasswordInput";var se=a(9013),ce=a(59353);function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},oe.apply(null,arguments)}const ie=F.z.object({email:F.z.string().email({message:"Email invalide"}).min(1,{message:"L'email est requis"}).max(255,{message:"L'email doit contenir moins de 255 caractères"}),password:F.z.string().min(1,{message:"Le mot de passe est requis"}).max(255,{message:"Le mot de passe doit contenir moins de 255 caractères"})});function me(e){let{isOpen:t,isClosing:a,closeModal:n}=e;const[l,s]=(0,r.useState)(!1),{register:o,getValues:i,handleSubmit:m,formState:{errors:d}}=(0,B.mN)({resolver:(0,q.u)(ie)});return React.createElement(Q,{isOpen:t,isClosing:a,className:"max-w-sm"},React.createElement(ee,{onClose:n},"Connexion"),React.createElement("form",{onSubmit:m((async()=>{const e=new FormData;e.append("username",i("email")),e.append("password",i("password"));try{s(!0);const t=await fetch("http://127.0.0.1/index.php/contestio/login/post/",{method:"POST",body:e});if(t.ok){const e=await t.json();e.success?window.location.reload():(s(!1),c.oR.error(e.message))}else s(!1),c.oR.error("Erreur lors de la connexion")}catch(e){console.error(e),s(!1)}})),className:"w-full flex flex-col gap-5"},React.createElement("div",{className:"w-full max-w-sm items-center gap-1.5 mb-2"},React.createElement(Z,{htmlFor:"email"},"Email"),React.createElement(I,oe({type:"email",id:"email",placeholder:"Email",maxLength:256},o("email"))),d.email&&React.createElement("span",{className:"text-sm text-destructive"},d.email.message)),React.createElement("div",{className:"w-full max-w-sm items-center gap-1.5"},React.createElement("div",{className:"w-full flex justify-between"},React.createElement(Z,{htmlFor:"password"},"Mot de passe"),React.createElement(U,{href:"http://127.0.0.1/index.php/customer/account/forgotpassword/",className:"text-sm text-muted-foreground"},"Mot de passe oublié ?")),React.createElement(le,oe({className:"w-full",placeholder:"Mot de passe",maxLength:256},o("password"))),d.password&&React.createElement("span",{className:"text-sm text-destructive"},d.password.message)),React.createElement(te,{className:"mt-2 flex flex-col gap-5 justify-center"},React.createElement(E,{type:"submit",disabled:l,className:"w-fit mx-auto flex items-center gap-2"},"Se connecter",K({icon:l?se.A:ce.A,className:"w-4 h-4 "+(l?"animate-spin":"")})),React.createElement("p",{className:"text-center text-sm text-muted-foreground"},"Je n'ai pas de compte ?"," ",React.createElement(U,{href:`http://127.0.0.1/index.php/customer/account/create/?redirect=${encodeURIComponent(window.location.href)}`,className:"text-contestio-purple"},"Créer un compte")))))}var de=a(35942),ue=a(24750);function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},pe.apply(null,arguments)}const fe=F.z.object({pseudo:F.z.string().min(2,{message:"Le pseudo doit contenir au moins 2 caractères."}).max(12,{message:"Le pseudo doit contenir moins de 12 caractères."}).regex(/^[a-zA-Z0-9_]+$/,{message:"Le pseudo ne peut contenir que des lettres, des chiffres et des underscores."})});function ge(e){let{isOpen:t,isClosing:a,closeModal:n}=e;const[l,s]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),{user:f,setUser:g}=p(),{register:v,handleSubmit:b,formState:{errors:w,isValid:x},setError:R}=(0,B.mN)({resolver:(0,q.u)(fe)});return React.createElement(Q,{isOpen:t,isClosing:a,className:"max-w-sm"},!0===d&&React.createElement("div",{className:"absolute top-0 left-0 w-full h-10 flex items-center justify-center"},React.createElement(ue.A,{zIndex:50})),React.createElement(ee,{onClose:n},"Hey ",f?.firstName," 👋"),!1===d?React.createElement("form",{onSubmit:b((async()=>{if(f&&f.id&&f.firstName&&f.lastName&&f.email)try{s(!0),await i("v1/users/final/upsert","POST",{externalId:f.id,fname:f.firstName,lname:f.lastName,email:f.email,pseudo:o})&&g({...f,pseudo:o}),c.oR.success(`Bienvenue ${o} !`,{description:"Votre pseudo a bien été enregistré."}),s(!1),u(!0)}catch(e){console.error(e),s(!1),c.oR.error("Une erreur est survenue lors de la modification de votre pseudo")}else c.oR.error("Une erreur est survenue lors de la récupération de vos informations")})),className:"flex flex-col gap-2"},React.createElement(L,null,React.createElement(_,{asChild:!0},React.createElement("p",{className:""},"Avant de continuer, pourriez-vous nous donner"," ",React.createElement("span",{className:"text-muted-foreground italic"},"votre pseudo")," ","?")),React.createElement(M,{className:"bg-white text-black",side:"right"},React.createElement("div",{className:"flex flex-col gap-2 max-w-[300px]"},React.createElement("p",{className:"font-semibold"},"Règles de création de pseudo :"),React.createElement("p",null,"Il doit être unique et ne peut contenir que des lettres, des chiffres et des underscores et doit contenir entre 2 et 12 caractères.")))),React.createElement("div",{className:"mt-3 w-full max-w-sm items-center"},React.createElement(I,pe({type:"text",id:"pseudo",placeholder:"Votre pseudo",maxLength:12,disabled:l,className:h("border-2 border-contestio-purple/50 text-contestio-purple font-medium text-center text-lg !h-10","placeholder:text-contestio-purple/50",!!w.pseudo?.message&&"border-destructive",l&&"bg-contestio-purple/20")},v("pseudo"),{onChange:e=>{(e=>{m(e.target.value),R("pseudo",{message:""})})(e),v("pseudo").onChange(e)}})),React.createElement("div",{className:"w-full flex justify-end items-center"},React.createElement("span",{className:"text-sm text-muted-foreground"},o?.length," / 12")),w.pseudo&&React.createElement("div",{className:"w-full text-center mt-1"},React.createElement("span",{className:"text-sm text-destructive font-semibold"},w.pseudo.message))),React.createElement(te,{className:"mt-2 flex flex-col gap-5 justify-center"},React.createElement(E,{type:"submit",disabled:l,className:"w-fit mx-auto flex items-center gap-2 p-4 text-md rounded-full"},"Valider",K({icon:l?se.A:de.A,className:"w-5 h-5 "+(l?"animate-spin":"")})),React.createElement("p",{className:"text-sm text-muted-foreground text-center"},"Il sera utilisé pour vous identifier lors de vos participations aux concours et sondages."))):React.createElement("div",{className:"flex flex-col gap-2 items-center"},React.createElement("p",{className:"text-lg font-semibold"},"Bienvenue",React.createElement("span",{className:"text-contestio-purple font-semibold ml-1"},f?.pseudo)," ","!"),React.createElement("p",{className:"mt-2 text-muted-foreground text-center"},"Vous pouvez désormais participer à nos concours et sondages."),React.createElement(te,{className:"mt-2"},React.createElement(E,{onClick:n,variant:"outline",className:"w-fit "},"Fermer"))))}const he=()=>{const e=(()=>{const[e,t]=(0,r.useState)(0),a=()=>{t(window.scrollY)};return(0,r.useEffect)((()=>(window.addEventListener("scroll",a),()=>{window.removeEventListener("scroll",a)})),[]),e})(),[t,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),s=(0,r.useRef)(0),c=document.getElementById("contestio-layout");(0,r.useEffect)((()=>{const e=e=>{"Escape"===e.key&&o()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[]),(0,r.useEffect)((()=>{if(!t)return;c&&(c.style.height="85vh",c.style.overflow="hidden"),s.current=e;const a=c?.getBoundingClientRect();window.scrollTo({top:window.scrollY+(a?.top||0)-7.5*window.innerHeight/100})}),[t]);const o=e=>{l(!0),setTimeout((()=>{l(!1);const e=document.querySelectorAll('[data-contestio-modal="open"]').length;c&&1===e&&(c.style.height="auto",c.style.overflow="auto"),a(!1),window.scrollTo({top:s.current})}),300)};return{isOpen:t,isClosing:n,openModal:()=>a(!0),closeModal:o}},ve=(0,r.createContext)({isLoginOpen:!1,isLoginClosing:!1,openLoginModal:()=>{},closeLoginModal:()=>{}}),be=()=>(0,r.useContext)(ve),we=e=>{let{children:t}=e;const{isOpen:a,isClosing:n,openModal:l,closeModal:s}=he();return r.createElement(ve.Provider,{value:{isLoginOpen:a,isLoginClosing:n,openLoginModal:l,closeLoginModal:s}},t)},xe=(0,r.createContext)({isPseudoOpen:!1,isPseudoClosing:!1,openPseudoModal:()=>{},closePseudoModal:()=>{}}),Ee=()=>(0,r.useContext)(xe),Re=e=>{let{children:t}=e;const{isOpen:a,isClosing:n,openModal:l,closeModal:s}=he();return r.createElement(xe.Provider,{value:{isPseudoOpen:a,isPseudoClosing:n,openPseudoModal:l,closePseudoModal:s}},t)},Ne=function(){const{isLoginOpen:e,isLoginClosing:t,closeLoginModal:a}=be(),{isPseudoOpen:r,isPseudoClosing:n,closePseudoModal:l}=Ee();return React.createElement("div",{className:h("bg-white border border-border/60 shadow-md rounded-2xl overflow-hidden relative","w-[94%] max-w-[1120px] my-6 mx-auto box-border")},React.createElement("div",{id:"contestio-layout",className:"relative w-full overflow-hidden"},React.createElement(z,null),React.createElement("div",{className:h("py-5 px-16 w-full")},React.createElement("main",{className:"w-full my-4"},React.createElement(s.sv,null),React.createElement(me,{isOpen:e,isClosing:t,closeModal:a}),React.createElement(ge,{isOpen:r,isClosing:n,closeModal:l})),React.createElement($,null))))};var ye=a(27933);function Ce(){return Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Ce.apply(null,arguments)}const ke=r.forwardRef(((e,t)=>{let{className:a,orientation:n="horizontal",decorative:l=!0,...s}=e;return r.createElement(ye.b,Ce({ref:t,decorative:l,orientation:n,className:h("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a)},s))}));function je(e){let{withoutButton:t=!1,withoutImage:a=!1,addSeperator:r=!1,addTitle:n=!1}=e;return React.createElement(React.Fragment,null,React.createElement("div",{className:h("w-full h-64 grid grid-cols-12 auto-rows-auto gap-4 items-center bg-white")},React.createElement("div",{className:h("h-full col-span-8",a&&"col-span-12")},n&&React.createElement(N,{className:"w-56 h-10 mb-5"}),React.createElement(N,{className:"w-full h-full"}),!t&&React.createElement(N,{className:"w-44 h-12 mt-4"})),!a&&React.createElement("div",{className:"h-full col-span-4"},React.createElement(N,{className:"m-auto w-5/6 h-4/5 rounded-xl shadow-md"}))),r&&React.createElement("div",{className:"col-span-12 w-3/5 mx-auto"},React.createElement(ke,{className:"my-0 w-full"})))}ke.displayName=ye.b.displayName;const Oe=function(){const{navButtons:e}=p(),t=(0,s.Zp)();return(0,r.useEffect)((()=>{var a;e.length>0&&(a=e[0].navUrl,t("contest"===a?"/contests":"survey"===a?"/surveys":"/"))}),[e]),React.createElement("div",{className:"w-full flex flex-col gap-20 my-10 mb-20"},React.createElement(je,{addSeperator:!0,withoutButton:!0}),React.createElement(je,null),React.createElement(je,null),React.createElement(je,null))},Se=function(){const{counter:e,incrementCounter:t}=p();return React.createElement("div",{className:"text-center"},React.createElement("header",{className:" min-h-screen flex flex-col items-center justify-center font-size-calc(10px + 2vmin)"},React.createElement("p",null,"Survey page ici"),React.createElement("div",null,React.createElement("p",null,"Counter: ",e),React.createElement(E,{variant:"default",onClick:t},"Increment")),React.createElement(E,{variant:"link"},React.createElement(l.N_,{to:"/"},"Revenir à l'accueil")),React.createElement(E,{variant:"default",onClick:()=>alert("Hello")},"Hello les surveys")))};var Pe=a(5204);const Ae=function(e){let{variant:t="default",className:a="",onClick:r,text:n,id:l,isActive:s=!1}=e;return React.createElement(E,{id:l,variant:t,onClick:r,className:h("text-white bg-contestio-purple border-2 border-contestio-purple rounded-lg shadow-md transition-all duration-300 text-center font-bold","hover:scale-95 hover:shadow-lg hover:bg-contestio-purple/90","active:bg-contestio-purple/70 active:shadow-sm",s&&"bg-contestio-purple/50 text-muted-foreground hover:scale-100",a)},n)},Le=function(e){let{datas:t,onClick:a,className:r,isActive:n=!1,variant:l="default"}=e;return React.createElement(React.Fragment,null,React.createElement("style",null,t.styles&&`#${t.slug} { ${t.styles} }`,t.hover&&`#${t.slug}:hover { ${t.hover} }`,t.focus&&`#${t.slug}:active { ${t.focus} }`),React.createElement(Ae,{id:t.slug,text:t.text,onClick:a,className:r,isActive:n,variant:l}))};function _e(e){let{type:t,description:a,presignedUrl:r,button:n,className:l,title:s,onClick:c}=e;return React.createElement(React.Fragment,null,React.createElement("div",{className:h("w-full h-full grid grid-cols-12 auto-rows-auto gap-4 items-center bg-white",l)},React.createElement("div",{className:h(r?"col-span-8":"col-span-12")},s&&React.createElement("h2",{className:"text-3xl font-bold mb-2"},s),React.createElement("div",{dangerouslySetInnerHTML:{__html:a},className:h("[&_p]:min-h-6","[&_a]:text-blue-500 [&_a]:underline","[&_ul]:list-disc [&_ul]:pl-10 [&_ul]:space-y-2","[&_ol]:list-decimal [&_ol]:pl-10 [&_ol]:space-y-2","[&_li]:min-h-6","[&_h2]:text-2xl [&_h2]:font-semibold [&_h2]:mb-1","[&_h3]:text-lg [&_h3]:font-semibold [&_h3]:mb-2","[&_strong]:font-bold","[&_em]:italic","[&_span]:font-medium")}),n&&React.createElement(Le,{datas:n,className:"mt-4",onClick:()=>c?.()})),r&&React.createElement("div",{className:"col-span-4"},React.createElement("img",{src:r,alt:"",className:"mx-auto w-5/6 h-auto object-cover rounded-xl shadow-md"}))),("homepage_header"===t||"banner"===t)&&React.createElement("div",{className:"col-span-12 w-3/5 mx-auto"},React.createElement(ke,{className:"my-0 w-full"})))}var Me=a(75779),ze=a(78541),Te=a(73072),Ue=a(3118);function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},$e.apply(null,arguments)}const Fe=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",$e({ref:t,className:h("rounded-lg border bg-card text-card-foreground shadow-sm",a)},n))}));Fe.displayName="Card",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",$e({ref:t,className:h("flex flex-col space-y-1.5 p-6",a)},n))})).displayName="CardHeader",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("h3",$e({ref:t,className:h("text-2xl font-semibold leading-none tracking-tight",a)},n))})).displayName="CardTitle",r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("p",$e({ref:t,className:h("text-sm text-muted-foreground",a)},n))})).displayName="CardDescription";const qe=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",$e({ref:t,className:h("p-6 pt-0",a)},n))}));qe.displayName="CardContent";const Be=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("div",$e({ref:t,className:h("flex items-center p-6 pt-0",a)},n))}));Be.displayName="CardFooter";var Ve=a(21749),Ie=a(78719),He=a(39916),De=a(11813),Je=a(32892);function Ze(){return Ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Ze.apply(null,arguments)}const Ge=He.bL,Ke=(He.YJ,He.WT),We=r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(He.l9,Ze({ref:t,className:h("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},l),n,r.createElement(He.In,{asChild:!0},K({icon:De.A,className:"h-4 w-4 opacity-50"})))}));We.displayName=He.l9.displayName;const Ye=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(He.PP,Ze({ref:t,className:h("flex cursor-default items-center justify-center py-1",a)},n),K({icon:Je.A,className:"h-4 w-4"}))}));Ye.displayName=He.PP.displayName;const Qe=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(He.wn,Ze({ref:t,className:h("flex cursor-default items-center justify-center py-1",a)},n),K({icon:De.A,className:"h-4 w-4"}))}));Qe.displayName=He.wn.displayName;const Xe=r.forwardRef(((e,t)=>{let{className:a,children:n,position:l="popper",...s}=e;return r.createElement(He.ZL,null,r.createElement(He.UC,Ze({ref:t,className:h("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l},s),r.createElement(Ye,null),r.createElement(He.LM,{className:h("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]")},n),r.createElement(Qe,null)))}));Xe.displayName=He.UC.displayName,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(He.JU,Ze({ref:t,className:h("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},n))})).displayName=He.JU.displayName;const et=r.forwardRef(((e,t)=>{let{className:a,children:n,...l}=e;return r.createElement(He.q7,Ze({ref:t,className:h("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 hover:bg-contestio-purple/10",a)},l),r.createElement("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},r.createElement(He.VF,null,K({icon:Ie.A,className:"h-4 w-4"}))),r.createElement(He.p4,null,n))}));function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},tt.apply(null,arguments)}et.displayName=He.q7.displayName,r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement(He.wv,Ze({ref:t,className:h("-mx-1 my-1 h-px bg-muted",a)},n))})).displayName=He.wv.displayName;const at=r.forwardRef(((e,t)=>{let{className:a,...n}=e;return r.createElement("textarea",tt({className:h("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t},n))}));at.displayName="Textarea";const rt=["Contenu inapproprié","Publicité ou spam","Discours haineux","Usurpation d’identité","Autre"];function nt(e){let{pseudo:t,_id:a}=e;const{isOpen:n,isClosing:l,openModal:s,closeModal:o}=he(),[i,d]=(0,r.useState)(null),[u,p]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),[h,v]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{n||(d(null),p(null),g(!1),w(!1),v(!1))}),[n]),(0,r.useEffect)((()=>{i?rt.includes(i)&&"Autre"!==i?g(!0):g(!("Autre"!==i||!u)):g(!1)}),[i,u]),React.createElement(React.Fragment,null,React.createElement(L,null,React.createElement(_,{className:"ml-auto",asChild:!0},React.createElement(E,{variant:"ghost-destructive",className:"w-10 h-10 p-0 text-black hover:text-destructive transition-all duration-300",onClick:s},K({icon:Ve.A,fill:"black",className:"w-6 h-6 "}))),React.createElement(M,{className:"bg-white text-black"},React.createElement("p",null,"Signaler"))),React.createElement(Q,{isOpen:n,isClosing:l,className:"max-w-md"},React.createElement(ee,{onClose:o},"Signalement"),React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("p",null,"Vous êtes sur le point de signaler la participation de"," ",React.createElement("strong",null,t),"."),React.createElement("p",null,"Sélectionnez le motif de votre signalement :"),React.createElement(Ge,{onValueChange:e=>d(e)},React.createElement(We,null,React.createElement(Ke,{placeholder:"Motif"})),React.createElement(Xe,null,rt.map((e=>React.createElement(et,{key:e,value:e},e))))),"Autre"===i&&React.createElement("div",{className:"flex flex-col gap-2"},React.createElement(at,{onChange:e=>p(e.target.value),placeholder:"Ajoutez un commentaire",maxLength:255},u),React.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},u?.length||0," / 255"))),React.createElement(te,null,React.createElement(E,{onClick:()=>o(),variant:"outline"},"Annuler"),React.createElement(E,{onClick:async()=>{if(f&&!h){v(!0);try{const{status:e}=await m(`v1/participation/flag/${a}`,"POST",{description:"Autre"===i?u:i});c.oR.success("Signalement envoyé avec succès !",{description:"Merci pour votre contribution à l'équité du concours."}),o()}catch(e){e instanceof Error?"Not found"===e.message?(c.oR.error("Cette participation n'existe pas."),o()):"Conflict"===e.message&&(c.oR.error("Vous avez déjà signalé cette participation."),o()):(console.error(e),c.oR.error("Une erreur est survenue lors du signalement."))}finally{v(!1)}}},disabled:!f||h||b,variant:"destructive",className:"flex items-center gap-2"},b?"Signalement envoyé":"Signaler",K({icon:b?Ie.A:h?se.A:Ve.A,className:"size-4 "+(h?"animate-spin":"")})))))}const lt=()=>{const{user:e}=p(),{openLoginModal:t}=be(),{openPseudoModal:a}=Ee();return()=>e&&e.firstName?e&&!e.pseudo?(a(),!0):!e||!e.pseudo:(t(),!0)},st=e=>{let{image:t,name:a,url:r,type:n="share",isRounded:l=!1,setReportOpen:s}=e;return React.createElement(L,null,React.createElement(_,{className:"report"===n?"ml-auto":"",asChild:!0},React.createElement(E,{variant:"report"===n?"ghost-destructive":"ghost",className:h("w-10 h-10 p-0","report"===n&&"text-black hover:text-destructive transition-all duration-300"),onClick:()=>{"share"===n?console.log("share",r):"copy"===n?(navigator.clipboard.writeText(r),c.oR.success("Lien copié avec succès !")):"report"===n&&s&&s(!0)}},"string"==typeof t?React.createElement("img",{src:t,alt:a||n,className:h("w-6 h-6",l?"rounded-full":"rounded-md")}):K({icon:t,fill:"black",className:"w-6 h-6 "}))),React.createElement(M,{className:"bg-white text-black"},"share"===n?React.createElement("p",null,"Partager sur ",React.createElement("strong",null,a)):"copy"===n?React.createElement("p",null,"Copier le lien"):"report"===n&&React.createElement("p",null,"Signaler")))};function ct(e){let{part:t,votedToday:a,defaultOpen:n=!1}=e;const[l,s]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),{isOpen:d,isClosing:u,openModal:p,closeModal:f}=he(),g=lt(),v=`${window.location.href.replace(/\?.*$/,"")}?ctst-u=${t.pseudo}`,b=encodeURIComponent(v),w=t.liked||!0===a||l;return(0,r.useEffect)((()=>{n&&p()}),[n]),(0,r.useEffect)((()=>{if(d){const e=new URL(window.location.href);e.searchParams.set("ctst-u",t.pseudo),window.history.pushState({path:e.href},"",e.href)}else{const e=new URL(window.location.href);e.searchParams.delete("ctst-u"),window.history.pushState({path:e.href},"",e.href)}}),[d]),React.createElement(React.Fragment,null,React.createElement(Fe,{onClick:p,className:h("border-border/30 shadow-lg cursor-pointer overflow-hidden","hover:shadow-2xl hover:border-border transition-all duration-300")},React.createElement(qe,{className:"pt-5 relative"},React.createElement("div",{className:"overflow-hidden rounded-xl"},React.createElement("img",{src:t.presignedUrl||"",alt:t.pseudo||"Image",className:h("w-full h-auto aspect-square rounded-xl shadow","transition-transform duration-300 hover:scale-110")}))),React.createElement(Be,{className:"flex flex-col gap-0"},React.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},React.createElement("p",{className:"font-medium text-md"},t.pseudo||""),React.createElement("div",{className:"flex flex-row gap-1 items-center"},K({icon:Me.A,fill:t.liked?"red-500":"transparent",filledRed:t.liked,className:`w-5 h-5 ${t.liked&&"text-red-500"}`}),t.likes||0)),React.createElement("p",{className:"w-full h-6 overflow-hidden text-ellipsis font-medium text-md text-muted-foreground"},t.description||""))),React.createElement(Q,{isOpen:d,isClosing:u},React.createElement(X,{onClick:f}),React.createElement("div",{className:"grid grid-cols-2 gap-5 after:content-none max-w-[50vw]"},React.createElement("div",{className:"w-full h-full"},React.createElement("img",{src:t.presignedUrl||"",alt:t.pseudo||"Image",className:h("w-full h-auto aspect-square rounded-xl shadow-xl","transition-transform duration-300 hover:scale-110")})),React.createElement("div",{className:"w-full h-full px-4 flex flex-col justify-between"},React.createElement("p",{className:"font-medium text-lg text-center"},"Participation de"," ",React.createElement("span",{className:"font-bold"},t.pseudo||"")),React.createElement("p",{className:"text-muted-foreground text-sm text-center p-4 border border-border rounded-md my-5 break-words"},t.description||React.createElement("span",{className:"italic"},"Aucune description ajoutée.")),React.createElement("div",{className:"my-5 mx-auto w-2/3 flex flex-col gap-5 items-center justify-between"},React.createElement("div",{className:"w-full flex flex-row gap-1 items-center justify-between"},React.createElement("div",{className:"flex flex-row gap-2 items-center"},K({icon:Me.A,filledRed:t.liked,className:`w-5 h-5 ${t.liked&&"text-red-500"}`}),t.likes||0),React.createElement("div",{className:"flex flex-row gap-2 items-center"},t.rank||0," ",1===t.rank?"er":"ème",K({icon:1===t.rank?ze.A:Te.A,className:"w-5 h-5 "+(1===t.rank?"text-yellow-400":"text-muted-foreground")}))),React.createElement(E,{className:"w-full rounded-full gap-2 relative",disabled:w,onClick:()=>{g()||(async()=>{s(!0);try{await i(`v1/participation/like/${t._id}`,"POST"),t.likes=t.likes+1,t.liked=!0,c.oR.success("Vote ajouté avec succès !"),m(!0)}catch(e){e instanceof Error?"Not found"===e.message?c.oR.error("Cette participation n'existe pas."):"Conflict"===e.message&&c.oR.error("Vous avez déjà voté pour cette participation aujourd'hui."):(console.error(e),c.oR.error("Une erreur est survenue lors de l'ajout du vote."))}finally{s(!1)}})()}},t.liked?"Vote ajouté":a?"Déjà voté aujourd'hui":"Voter",o&&React.createElement("div",{className:"absolute top-0 left-0 w-full h-10 flex items-center justify-center"},React.createElement(ue.A,{zIndex:50,force:.4,particleCount:30,width:300})),K({icon:l?se.A:Me.A,fill:"white",className:`w-5 h-5 text-white ${!1===w&&"animate-hi-there"} ${l&&"animate-spin"}`}))),React.createElement("footer",null,React.createElement("div",null,React.createElement("p",{className:"w-full font-light text-sm text-muted-foreground"},"Partager sur :"),React.createElement("div",null,React.createElement("div",{className:"flex flex-row gap-2 items-center"},st({image:"/skin/frontend/base/default/reactjs-app/images/facebook.png",name:"Facebook",url:`https://www.facebook.com/sharer/sharer.php?u=${v}`,type:"share"}),st({image:"/skin/frontend/base/default/reactjs-app/images/twitter.webp",name:"Twitter",url:`https://twitter.com/intent/tweet?url=${b}`,type:"share",isRounded:!0}),st({image:"/skin/frontend/base/default/reactjs-app/images/messenger.png",name:"Messenger",url:`https://www.messenger.com/send?text=${b}`,type:"share"}),st({image:Ue.A,url:v,type:"copy"}),React.createElement(nt,{pseudo:t.pseudo,_id:t._id})))))))))}function ot(){return React.createElement(React.Fragment,null,React.createElement("span",null),React.createElement(Fe,{className:h("border-border/30 shadow-lg overflow-hidden","hover:shadow-2xl hover:border-border transition-all duration-300")},React.createElement(qe,{className:"pt-5 relative"},React.createElement("div",{className:"overflow-hidden rounded-xl"},React.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/podium.svg",alt:"No participants",className:h("w-full h-auto aspect-square rounded-xl shadow object-contain","transition-transform duration-300 hover:scale-110")}))),React.createElement(Be,{className:"flex flex-col gap-0"},React.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},React.createElement("p",{className:"font-medium text-md"},"Aucune participation trouvée !")),React.createElement("p",{className:"w-full font-medium text-md text-muted-foreground"},"Soyez le premier à participer à ce concours !")),React.createElement("span",null)))}var it=a(69047),mt=a(14320),dt=a(41087);function ut(e){let{loading:t,sort:a,sortBy:n,setSort:l,setSortBy:s,changeSort:c}=e;const{isOpen:o,isClosing:i,openModal:m,closeModal:d}=he(),[u,p]=(0,r.useState)(a.current||"asc"),[f,g]=(0,r.useState)(n.current||"likes");return React.createElement(React.Fragment,null,React.createElement(E,{variant:"ghost",className:"flex items-center gap-2",disabled:t,onClick:m},"Trier par",K({icon:it.A,className:"w-5 h-5"})),React.createElement(Q,{isOpen:o,isClosing:i},React.createElement(ee,{onClose:d},"Trier par"),React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement(I,{type:"radio",id:"populars",name:"sortBy",value:"populars",className:"w-4 h-4",defaultChecked:"likes"===n.current&&"desc"===a.current,onChange:()=>{g("likes"),p("desc")}}),React.createElement("label",{htmlFor:"populars",className:"flex items-center gap-2"},"Les plus populaires",K({icon:mt.A,className:"w-5 h-5"}))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement(I,{type:"radio",id:"unpopulars",name:"sortBy",value:"unpopulars",className:"w-4 h-4",defaultChecked:"likes"===n.current&&"asc"===a.current,onChange:()=>{g("likes"),p("asc")}}),React.createElement("label",{htmlFor:"unpopulars"},"Les moins populaires")),React.createElement("div",{className:"flex items-center gap-2"},React.createElement(I,{type:"radio",id:"recents",name:"sortBy",value:"recents",className:"w-4 h-4",defaultChecked:"createdAt"===n.current&&"desc"===a.current,onChange:()=>{g("createdAt"),p("desc")}}),React.createElement("label",{htmlFor:"recents",className:"flex items-center gap-2"},"Les plus récents",K({icon:dt.A,className:"w-5 h-5"}))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement(I,{type:"radio",id:"oldest",name:"sortBy",value:"oldest",className:"w-4 h-4",defaultChecked:"createdAt"===n.current&&"asc"===a.current,onChange:()=>{g("createdAt"),p("asc")}}),React.createElement("label",{htmlFor:"oldest"},"Les plus anciens"))),React.createElement(te,null,React.createElement(E,{onClick:()=>{l(u),s(f),d(),c()}},"Valider"))))}var pt=a(12851);function ft(e){let{loading:t,participations:a,totalParticipations:r,search:n,setSearch:l,changeSort:s,sort:c,sortBy:o,setSort:i,setSortBy:m,resetSearch:d}=e;return React.createElement("div",{className:"w-full flex flex-row justify-between items-center gap-5 my-10"},t&&0===a.length?React.createElement(N,{className:"w-40 h-10 rounded-xl"}):React.createElement("p",{className:"font-medium text-md text-muted-foreground"},r," participation",r>1&&"s"),React.createElement("div",{className:"mx-auto flex w-2/5 items-center space-x-2 h-10"},React.createElement("div",{className:"relative w-full h-full"},React.createElement(I,{type:"text",placeholder:"Rechercher un participant",className:"min-h-10 !h-full",value:n||"",readOnly:t,maxLength:30,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key&&s()}}),n&&n.length>0&&React.createElement(E,{type:"button",variant:"link",className:"absolute right-2 top-1/2 -translate-y-1/2 h-full aspect-square p-1",onClick:d},K({icon:W.A,className:"w-5 h-5"}))),React.createElement(E,{type:"submit",className:"m-2 h-full w-auto aspect-square bg-contestio-purple hover:bg-contestio-purple/90",disabled:t,onClick:s},K({icon:t?se.A:pt.A,className:"w-5 h-5 "+(t?"animate-spin":"")}))),React.createElement(ut,{loading:t||0===a.length,sort:c,sortBy:o,setSort:i,setSortBy:m,changeSort:s}))}function gt(){return React.createElement(Fe,{className:h("border-border/30 shadow-lg cursor-pointer","hover:shadow-2xl hover:border-border transition-all duration-300")},React.createElement(qe,{className:"pt-5"},React.createElement(N,{className:"w-full h-auto aspect-square rounded-xl"})),React.createElement(Be,{className:"flex flex-col gap-2"},React.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},React.createElement(N,{className:"w-44 h-5 rounded-xl"}),React.createElement(N,{className:"w-12 h-6 rounded-xl"})),React.createElement(N,{className:"w-full h-5 rounded-xl"})))}function ht(){return React.createElement(React.Fragment,null,React.createElement("span",null),React.createElement(Fe,{className:h("border-border/30 shadow-lg overflow-hidden","hover:shadow-2xl hover:border-border transition-all duration-300")},React.createElement(qe,{className:"pt-5 relative"},React.createElement("div",{className:"overflow-hidden rounded-xl"},React.createElement("img",{src:"/skin/frontend/base/default/reactjs-app/images/notFound.svg",alt:"Not found",className:h("w-full h-auto aspect-square rounded-xl shadow","transition-transform duration-300 hover:scale-110")}))),React.createElement(Be,{className:"flex flex-col gap-0"},React.createElement("div",{className:"w-full flex flex-row gap-5 justify-between items-center"},React.createElement("p",{className:"font-medium text-md"},"Aucun utilisateur trouvé !")),React.createElement("p",{className:"w-full font-medium text-md text-muted-foreground"},"Vérifiez que le pseudo est correct et essayez de nouveau...")),React.createElement("span",null)))}var vt=a(22869);function bt(e){let{onFileChange:t}=e;return React.createElement("div",{className:"mt-3 mb-5 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-gray-400 transition-colors",onDrop:e=>{e.preventDefault();const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")&&t(a)},onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("border-blue-500","bg-blue-50")},onDragLeave:e=>{e.currentTarget.classList.remove("border-blue-500","bg-blue-50")}},React.createElement("p",{className:"text-gray-500 mb-2"},"Glissez et déposez votre image ici"),React.createElement("p",{className:"text-sm text-gray-400"},"ou"),React.createElement("label",{htmlFor:"file-upload",className:"mt-2 inline-block bg-blue-500 text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-600 transition-colors"},"Sélectionnez un fichier"),React.createElement("input",{id:"file-upload",type:"file",accept:"image/*",onChange:e=>{const a=e.target.files?.[0];a&&t(a)},className:"hidden"}))}var wt=a(71083);function xt(){return xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},xt.apply(null,arguments)}const Et=F.z.object({comment:F.z.string().max(255),terms:F.z.boolean().refine((e=>!0===e),{message:"Vous devez accepter les règles du concours"})});function Rt(e){let{contestId:t,isOpen:a,isClosing:n,closeModal:l,settlementUrl:s}=e;const[o,i]=(0,r.useState)(!1),[d,u]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),g=(0,r.useRef)(null),[v,b]=(0,r.useState)(),[w,x]=(0,r.useState)(),[R,N]=(0,r.useState)(!1),[y,C]=(0,r.useState)(null),{register:k,getValues:j,handleSubmit:O,formState:{errors:S}}=(0,B.mN)({resolver:(0,q.u)(Et)});return React.createElement(Q,{isOpen:a,isClosing:n,className:"w-[55vw] max-w-[800px]"},React.createElement(ee,{onClose:l},"Nouvelle participation"),React.createElement("div",{className:"flex flex-col gap-4 justify-center items-center"},React.createElement("div",{className:"w-full max-w-[400px] flex flex-col gap-4"},o&&React.createElement("div",{className:"h-56 flex flex-col gap-2 justify-center items-center border border-border shadow p-4 rounded-md"},React.createElement("p",null,"Vérification de l'image"),K({icon:se.A,className:"w-7 h-7 animate-spin text-contestio-purple"})),!o&&!d&&React.createElement(bt,{onFileChange:async e=>{if(e){b(void 0);try{i(!0);const a=new FormData;a.append("file",e,e.name);const{data:r}=await wt.A.post(`http://127.0.0.1/index.php/contestio/api/proxy?endpoint=v1/participation/check-image/${t}`,a,{headers:{"Content-Type":"multipart/form-data"}}),n=new Image;n.src="data:application/octet-stream;base64,"+r,n.onload=function(){u(n.src)},n.onerror=()=>{u(""),c.oR.error("Une erreur est survenue lors de la vérification de l'image")}}catch(e){console.error(e),c.oR.error("Une erreur est survenue lors de la vérification de l'image")}finally{i(!1)}}else u("")}}),!o&&!!d&&!p&&React.createElement("div",{className:"flex flex-col gap-2 justify-center items-center border border-border shadow pb-2 rounded-md"},React.createElement(vt.Ay,{crop:v,onChange:(e,t)=>b(t),onComplete:e=>x(e),aspect:1,minHeight:100,className:"w-full h-full"},React.createElement("img",{ref:g,alt:"Crop me",src:d,className:"w-full h-full object-contain !max-w-[400px] !max-h-[400px]",onLoad:e=>{const{width:t,height:a}=e.currentTarget;var r,n;b((r=t,n=a,(0,vt.ge)((0,vt.dS)({unit:"%",width:90},1,r,n),r,n)))}})),React.createElement("div",{className:"px-2 w-full flex justify-between gap-2"},React.createElement(E,{onClick:()=>u(""),variant:"ghost-destructive",className:"w-fit gap-2"},"Supprimer",K({icon:W.A,className:"w-5 h-5"})),React.createElement(E,{className:"gap-2",onClick:()=>{const e=document.createElement("canvas"),t=e.getContext("2d");if(!w)return void console.error("No crop selected");if(!g.current)return void console.error("No image loaded");if(!t)return void console.error("Failed to get canvas context");const a=g.current.naturalWidth/g.current.width,r=g.current.naturalHeight/g.current.height,n=window.devicePixelRatio;e.width=Math.floor(w.width*a*n),e.height=Math.floor(w.height*r*n),t.scale(n,n),t.imageSmoothingQuality="high";const l=w.x*a,s=w.y*r;t.drawImage(g.current,l,s,w.width*a,w.height*r,0,0,w.width*a,w.height*r);const c=e.toDataURL("image/webp");f(c),e.toBlob((e=>{e&&C(e)}),"image/webp")},type:"button"},React.createElement("span",null,"Valider"),K({icon:Ie.A,className:"w-5 h-5"})))))),!o&&!!p&&React.createElement("div",{className:"grid grid-cols-2 gap-2 items-center"},React.createElement("div",{className:"max-w-[200px] mx-auto flex flex-col gap-2 justify-center items-center border border-border shadow pb-2 rounded-md"},React.createElement("img",{src:p,className:"w-full h-full aspect-square !max-w-[200px] !max-h-[200px]"}),React.createElement("div",{className:"px-2 w-full flex justify-center gap-2"},React.createElement(E,{onClick:()=>f(""),variant:"ghost-destructive",className:"w-fit gap-2"},"Supprimer",K({icon:W.A,className:"w-5 h-5"})))),React.createElement("form",{className:"flex flex-col items-center gap-2 border border-border shadow p-5 rounded-md",onSubmit:O((async()=>{if(y)try{N(!0);const e=new FormData;e.append("file",y,"image.webp");const{data:a,status:r}=await wt.A.post(`http://127.0.0.1/index.php/contestio/api/proxy?endpoint=v1/participation/upload-image/${t}`,e,{headers:{"Content-Type":"multipart/form-data"}});if(200!==r&&201!==r)throw c.oR.error("Une erreur est survenue lors du téléchargement de votre image"),new Error("Failed to upload image");await m(`v1/participation/${t}`,"POST",{imageUrl:a.presignedUrl,description:j("comment")}),c.oR.success("Votre participation a bien été prise en compte"),l()}catch(e){console.error(e)}finally{N(!1)}else c.oR.error("Une erreur est survenue lors du téléchargement de votre image")}))},React.createElement("div",{className:"w-full flex flex-col gap-2 my-4"},React.createElement(at,xt({placeholder:"Ajouter une description (facultatif)",maxLength:200},k("comment"))),React.createElement("p",{className:"text-sm text-muted-foreground ml-auto"},j("comment")?.length||0," / 200")),React.createElement("div",{className:"flex items-center justify-center gap-2"},React.createElement("input",xt({type:"checkbox",id:"terms"},k("terms"),{className:h("peer",S.terms&&"border-destructive text-destructive")})),React.createElement("label",{htmlFor:"terms",className:h("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",S.terms&&"text-destructive")},"J'ai lu et j'accepte"," ",React.createElement("a",{href:s,target:"_blank",className:"underline"},"les règles du concours"),".")),React.createElement(E,{type:"submit",className:"mt-4 w-full gap-2",disabled:R},"Participer au concours"," ",K({icon:R?se.A:Ie.A,className:"w-5 h-5 "+(R?"animate-spin":"")})))))}const Nt=function(){const[e]=(0,l.ok)(),t=lt(),{isOpen:a,isClosing:n,openModal:s,closeModal:c}=he(),m=(0,r.useRef)(e.get("ctst-q")),d=(0,r.useRef)(e.get("ctst-u")),u=(0,r.useRef)(1),f=(0,r.useRef)("desc"),g=(0,r.useRef)("likes"),[h,v]=(0,r.useState)(d.current?d.current:m.current||""),[b,w]=(0,r.useState)(!0),[x,R]=(0,r.useState)([]),[N,y]=(0,r.useState)({limit:0,page:0,totalPages:0,totalParticipations:0}),{contestsLoading:C,setContestsLoading:k,contestsContent:j,setContestsContent:O}=p();(0,r.useEffect)((()=>{console.log("Contest juste mounted"),C&&P()}),[]),(0,r.useEffect)((()=>{L()}),[j]),(0,r.useEffect)((()=>{if(!b)if(m.current=h,h.length>0){const e=new URL(window.location.href);e.searchParams.set("ctst-q",h),window.history.pushState({path:e.href},"",e.href)}else{const e=new URL(window.location.href);e.searchParams.delete("ctst-q"),window.history.pushState({path:e.href},"",e.href)}}),[h]);const S=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];w(!0),u.current=1,R([]);const t=await A(j?.contest?.slug||"",e);R(t)},P=async()=>{try{const e=await i("v1/contests/metadatas");O(e)}catch(e){console.error("Erreur de fetch:",e)}finally{k(!1)}},A=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];w(!0);try{const a=await i(`v1/contests/${e}/${g.current}/${f.current}/${u.current}?search=${t?"":h}`);return y({limit:a.limit||0,page:a.page||0,totalPages:a.totalPages||0,totalParticipations:a.totalParticipations||0}),a.participations||[]}catch(e){console.error("Erreur de fetch:",e)}finally{w(!1)}},L=async()=>{if(!j?.contest?.slug)return;const e=(await A(j?.contest?.slug||"")).filter((e=>!x.some((t=>t._id===e._id))));R([...x,...e])};return C?React.createElement("div",{className:"w-full flex flex-col gap-20 my-20"},React.createElement(je,{addSeperator:!0,withoutButton:!0}),React.createElement(je,{addTitle:!0,withoutImage:!0})):React.createElement("section",{className:"flex flex-col items-center justify-center"},React.createElement(o.mg,null,React.createElement("meta",{property:"og:title",content:`Concours ${j?.contest?.name}`}),React.createElement("meta",{property:"og:description",content:j?.contest?.description}),React.createElement("meta",{property:"og:image",content:j?.banner?.presignedUrl})),j?.contest&&React.createElement("div",{className:"w-full flex flex-col gap-20 mb-10"},React.createElement(_e,{type:j.contest.type,title:j.contest.name,description:j.contest.description,button:j.contest.buttonParticipate,onClick:()=>{t()||s()}})),React.createElement(Rt,{contestId:j?.contest?._id||"",settlementUrl:j?.contest?.settlement||"",isOpen:a,isClosing:n,closeModal:c}),React.createElement(ft,{loading:b,participations:x,totalParticipations:N.totalParticipations,search:h,setSearch:e=>{v(e)},changeSort:S,sort:f,sortBy:g,setSort:e=>{f.current=e},setSortBy:e=>{g.current=e},resetSearch:()=>{v(""),m.current="",d.current="",S(!0)}}),React.createElement("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-10 after:content-none"},b&&0===x.length?React.createElement(React.Fragment,null,React.createElement(gt,null),React.createElement(gt,null),React.createElement(gt,null),React.createElement(gt,null),React.createElement(gt,null),React.createElement(gt,null)):x.map((e=>React.createElement(ct,{key:e._id,part:e,votedToday:j?.votedToday||!1,defaultOpen:null!==d.current&&d.current===e.pseudo}))),b||0!==x.length?null:h.length>0?React.createElement(ht,null):React.createElement(ot,null),b&&React.createElement(React.Fragment,null,React.createElement(gt,null),React.createElement(gt,null),React.createElement(gt,null))),N.totalPages>1&&u.current<N.totalPages&&React.createElement(E,{variant:"ghost",disabled:b,onClick:()=>{u.current+=1,L()},className:"flex items-center gap-2 mt-10"},"Voir plus"," ",K(b?{icon:se.A,className:"size-5 animate-spin"}:{icon:Pe.A,className:"size-5"})))},yt=function(){const e=window.location.href.includes("contestio")?"/index.php/contestio":"/";return React.createElement(l.Kd,{basename:e},React.createElement(u,null,React.createElement(c.l$,null),React.createElement(o.vd,null,React.createElement(A,null,React.createElement(we,null,React.createElement(Re,null,React.createElement(s.BV,null,React.createElement(s.qh,{element:React.createElement(Ne,null)},React.createElement(s.qh,{path:"/contests",element:React.createElement(Nt,null)}),React.createElement(s.qh,{path:"/surveys",element:React.createElement(Se,null)}),React.createElement(s.qh,{path:"/",element:React.createElement(Oe,null)})))))))))};n.createRoot(document.getElementById("root")).render(r.createElement(r.StrictMode,null,r.createElement(yt,null)))}},n={};function l(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(a.exports,a,a.exports,l),a.loaded=!0,a.exports}l.m=r,e=[],l.O=(t,a,r,n)=>{if(!a){var s=1/0;for(m=0;m<e.length;m++){a=e[m][0],r=e[m][1],n=e[m][2];for(var c=!0,o=0;o<a.length;o++)(!1&n||s>=n)&&Object.keys(l.O).every((e=>l.O[e](a[o])))?a.splice(o--,1):(c=!1,n<s&&(s=n));if(c){e.splice(m--,1);var i=r();void 0!==i&&(t=i)}}return t}n=n||0;for(var m=e.length;m>0&&e[m-1][2]>n;m--)e[m]=e[m-1];e[m]=[a,r,n]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var n=Object.create(null);l.r(n);var s={};t=t||[null,a({}),a([]),a(a)];for(var c=2&r&&e;"object"==typeof c&&!~t.indexOf(c);c=a(c))Object.getOwnPropertyNames(c).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,l.d(n,s),n},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={792:0};l.O.j=t=>0===e[t];var t=(t,a)=>{var r,n,s=a[0],c=a[1],o=a[2],i=0;if(s.some((t=>0!==e[t]))){for(r in c)l.o(c,r)&&(l.m[r]=c[r]);if(o)var m=o(l)}for(t&&t(a);i<s.length;i++)n=s[i],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(m)},a=self.webpackChunkreactts_app=self.webpackChunkreactts_app||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),l.nc=void 0,l.O(void 0,[96],(()=>l(84315))),l.O(void 0,[96],(()=>l(7452)));var s=l.O(void 0,[96],(()=>l(7509)));s=l.O(s)})();